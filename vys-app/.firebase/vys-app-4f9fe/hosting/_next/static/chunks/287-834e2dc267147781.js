(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[287],{208:(e,t,r)=>{"use strict";r.d(t,{DT:()=>i,mj:()=>h}),r(898);var n=r(9733),s=r(1454);function i(e,t){let r=(0,n.t)(t);if(!r.includes(e.type)){let t=1===r.length?`type "${r[0]}"`:`one of types "${r.join('", "')}"`;throw Error(`Expected event ${JSON.stringify(e)} to have ${t}`)}}let o=new WeakMap;function a(e,t,r){let n=o.get(e);return n?t in n||(n[t]=r()):(n={[t]:r()},o.set(e,n)),n[t]}let l={},c=e=>"string"==typeof e?{type:e}:"function"==typeof e?"resolve"in e?{type:e.type}:{type:e.name}:e;class u{constructor(e,t){if(this.config=e,this.key=void 0,this.id=void 0,this.type=void 0,this.path=void 0,this.states=void 0,this.history=void 0,this.entry=void 0,this.exit=void 0,this.parent=void 0,this.machine=void 0,this.meta=void 0,this.output=void 0,this.order=-1,this.description=void 0,this.tags=[],this.transitions=void 0,this.always=void 0,this.parent=t._parent,this.key=t._key,this.machine=t._machine,this.path=this.parent?this.parent.path.concat(this.key):[],this.id=this.config.id||[this.machine.id,...this.path].join(n.S),this.type=this.config.type||(this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.description=this.config.description,this.order=this.machine.idMap.size,this.machine.idMap.set(this.id,this),this.states=this.config.states?(0,n.m)(this.config.states,(e,t)=>new u(e,{_parent:this,_key:t,_machine:this.machine})):l,"compound"===this.type&&!this.config.initial)throw Error(`No initial state specified for compound state node "#${this.id}". Try adding { initial: "${Object.keys(this.states)[0]}" } to the state config.`);this.history=!0===this.config.history?"shallow":this.config.history||!1,this.entry=(0,n.t)(this.config.entry).slice(),this.exit=(0,n.t)(this.config.exit).slice(),this.meta=this.config.meta,this.output="final"!==this.type&&this.parent?void 0:this.config.output,this.tags=(0,n.t)(e.tags).slice()}_initialize(){this.transitions=(0,n.f)(this),this.config.always&&(this.always=(0,n.a)(this.config.always).map(e=>(0,n.b)(this,n.N,e))),Object.keys(this.states).forEach(e=>{this.states[e]._initialize()})}get definition(){return{id:this.id,key:this.key,version:this.machine.version,type:this.type,initial:this.initial?{target:this.initial.target,source:this,actions:this.initial.actions.map(c),eventType:null,reenter:!1,toJSON:()=>({target:this.initial.target.map(e=>`#${e.id}`),source:`#${this.id}`,actions:this.initial.actions.map(c),eventType:null})}:void 0,history:this.history,states:(0,n.m)(this.states,e=>e.definition),on:this.on,transitions:[...this.transitions.values()].flat().map(e=>({...e,actions:e.actions.map(c)})),entry:this.entry.map(c),exit:this.exit.map(c),meta:this.meta,order:this.order||-1,output:this.output,invoke:this.invoke,description:this.description,tags:this.tags}}toJSON(){return this.definition}get invoke(){return a(this,"invoke",()=>(0,n.t)(this.config.invoke).map((e,t)=>{let{src:r,systemId:s}=e,i=e.id??(0,n.c)(this.id,t),o="string"==typeof r?r:`xstate.invoke.${(0,n.c)(this.id,t)}`;return{...e,src:o,id:i,systemId:s,toJSON(){let{onDone:t,onError:r,...n}=e;return{...n,type:"xstate.invoke",src:o,id:i}}}}))}get on(){return a(this,"on",()=>[...this.transitions].flatMap(([e,t])=>t.map(t=>[e,t])).reduce((e,[t,r])=>(e[t]=e[t]||[],e[t].push(r),e),{}))}get after(){return a(this,"delayedTransitions",()=>(0,n.g)(this))}get initial(){return a(this,"initial",()=>(0,n.d)(this,this.config.initial))}next(e,t){let r,s=t.type,i=[];for(let o of a(this,`candidates-${s}`,()=>(0,n.h)(this,s))){let{guard:a}=o,l=e.context,c=!1;try{c=!a||(0,n.e)(a,l,t,e)}catch(t){let e="string"==typeof a?a:"object"==typeof a?a.type:void 0;throw Error(`Unable to evaluate guard ${e?`'${e}' `:""}in transition for event '${s}' in state node '${this.id}':
${t.message}`)}if(c){i.push(...o.actions),r=o;break}}return r?[r]:void 0}get events(){return a(this,"events",()=>{let{states:e}=this,t=new Set(this.ownEvents);if(e)for(let r of Object.keys(e)){let n=e[r];if(n.states)for(let e of n.events)t.add(`${e}`)}return Array.from(t)})}get ownEvents(){return Array.from(new Set([...this.transitions.keys()].filter(e=>this.transitions.get(e).some(e=>!(!e.target&&!e.actions.length&&!e.reenter)))))}}class d{constructor(e,t){this.config=e,this.version=void 0,this.schemas=void 0,this.implementations=void 0,this.__xstatenode=!0,this.idMap=new Map,this.root=void 0,this.id=void 0,this.states=void 0,this.events=void 0,this.id=e.id||"(machine)",this.implementations={actors:t?.actors??{},actions:t?.actions??{},delays:t?.delays??{},guards:t?.guards??{}},this.version=this.config.version,this.schemas=this.config.schemas,this.transition=this.transition.bind(this),this.getInitialSnapshot=this.getInitialSnapshot.bind(this),this.getPersistedSnapshot=this.getPersistedSnapshot.bind(this),this.restoreSnapshot=this.restoreSnapshot.bind(this),this.start=this.start.bind(this),this.root=new u(e,{_key:this.id,_machine:this}),this.root._initialize(),this.states=this.root.states,this.events=this.root.events}provide(e){let{actions:t,guards:r,actors:n,delays:s}=this.implementations;return new d(this.config,{actions:{...t,...e.actions},guards:{...r,...e.guards},actors:{...n,...e.actors},delays:{...s,...e.delays}})}resolveState(e){let t=(0,n.r)(this.root,e.value),r=(0,n.i)((0,n.j)(this.root,t));return(0,n.k)({_nodes:[...r],context:e.context||{},children:{},status:(0,n.l)(r,this.root)?"done":e.status||"active",output:e.output,error:e.error,historyValue:e.historyValue},this)}transition(e,t,r){return(0,n.n)(e,t,r,[]).snapshot}microstep(e,t,r){return(0,n.n)(e,t,r,[]).microstates}getTransitionData(e,t){return(0,n.o)(this.root,e.value,e,t)||[]}getPreInitialState(e,t,r){let{context:i}=this.config,o=(0,n.k)({context:"function"!=typeof i&&i?i:{},_nodes:[this.root],children:{},status:"active"},this);return"function"==typeof i?(0,n.p)(o,t,e,[(0,s.a)(({spawn:e,event:t,self:r})=>i({spawn:e,input:t.input,self:r}))],r,void 0):o}getInitialSnapshot(e,t){let r=(0,n.q)(t),s=[],i=this.getPreInitialState(e,r,s),o=(0,n.s)([{target:[...(0,n.u)(this.root)],source:this.root,reenter:!0,actions:[],eventType:null,toJSON:null}],i,e,r,!0,s),{snapshot:a}=(0,n.n)(o,r,e,s);return a}start(e){Object.values(e.children).forEach(e=>{"active"===e.getSnapshot().status&&e.start()})}getStateNodeById(e){let t=(0,n.v)(e),r=t.slice(1),s=(0,n.w)(t[0])?t[0].slice(1):t[0],i=this.idMap.get(s);if(!i)throw Error(`Child state node '#${s}' does not exist on machine '${this.id}'`);return(0,n.x)(i,r)}get definition(){return this.root.definition}toJSON(){return this.definition}getPersistedSnapshot(e,t){return(0,n.y)(e,t)}restoreSnapshot(e,t){let r={},s=e.children;Object.keys(s).forEach(e=>{let i=s[e],o=i.snapshot,a=i.src,l="string"==typeof a?(0,n.z)(this,a):a;if(!l)return;let c=(0,n.A)(l,{id:e,parent:t.self,syncSnapshot:i.syncSnapshot,snapshot:o,src:a,systemId:i.systemId});r[e]=c});let i=function(e,t){if(!t||"object"!=typeof t)return{};let r={};for(let n in t)for(let s of t[n]){let t=function(e,t){if(t instanceof u)return t;try{return e.machine.getStateNodeById(t.id)}catch{}}(e,s);t&&(r[n]??=[],r[n].push(t))}return r}(this.root,e.historyValue),o=(0,n.k)({...e,children:r,_nodes:Array.from((0,n.i)((0,n.j)(this.root,e.value))),historyValue:i},this),a=new Set;return!function e(t,r){if(!a.has(t))for(let s in a.add(t),t){let i=t[s];if(i&&"object"==typeof i){if("xstate$$type"in i&&i.xstate$$type===n.$){t[s]=r[i.id];continue}e(i,r)}}}(o.context,r),o}}function h({schemas:e,actors:t,actions:r,guards:n,delays:s}){return{createMachine:i=>new d({...i,schemas:e},{actors:t,actions:r,guards:n,delays:s})}}},898:(e,t,r)=>{"use strict";r.d(t,{SP:()=>i,Sx:()=>c});var n=r(9733);let s=new WeakMap;function i(e){return{config:e,start:(t,r)=>{let{self:n,system:i,emit:o}=r,a={receivers:void 0,dispose:void 0};s.set(n,a),a.dispose=e({input:t.input,system:i,self:n,sendBack:e=>{"stopped"!==n.getSnapshot().status&&n._parent&&i._relay(n,n._parent,e)},receive:e=>{a.receivers??=new Set,a.receivers.add(e)},emit:o})},transition:(e,t,r)=>{let i=s.get(r.self);return t.type===n.X?(e={...e,status:"stopped",error:void 0},i.dispose?.()):i.receivers?.forEach(e=>e(t)),e},getInitialSnapshot:(e,t)=>({status:"active",output:void 0,error:void 0,input:t}),getPersistedSnapshot:e=>e,restoreSnapshot:e=>e}}let o="xstate.promise.resolve",a="xstate.promise.reject",l=new WeakMap;function c(e){return{config:e,transition:(e,t,r)=>{if("active"!==e.status)return e;switch(t.type){case o:{let r=t.data;return{...e,status:"done",output:r,input:void 0}}case a:return{...e,status:"error",error:t.data,input:void 0};case n.X:return l.get(r.self)?.abort(),{...e,status:"stopped",input:void 0};default:return e}},start:(t,{self:r,system:n,emit:s})=>{if("active"!==t.status)return;let i=new AbortController;l.set(r,i),Promise.resolve(e({input:t.input,system:n,self:r,signal:i.signal,emit:s})).then(e=>{"active"===r.getSnapshot().status&&(l.delete(r),n._relay(r,r,{type:o,data:e}))},e=>{"active"===r.getSnapshot().status&&(l.delete(r),n._relay(r,r,{type:a,data:e}))})},getInitialSnapshot:(e,t)=>({status:"active",output:void 0,error:void 0,input:t}),getPersistedSnapshot:e=>e,restoreSnapshot:e=>e}}(function(e,t){;})(e=>void 0,void 0)},901:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return n}});let n=r(8229)._(r(2115)).default.createContext(null)},1454:(e,t,r)=>{"use strict";r.d(t,{a:()=>i,b:()=>m,c:()=>h,l:()=>y,s:()=>p});var n=r(9733);function s(e,t,r,s,{assignment:i}){if(!t.context)throw Error("Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.");let o={},a={context:t.context,event:r.event,spawn:function(e,{machine:t,context:r},s,i){let o=(o,a)=>{if("string"!=typeof o)return(0,n.A)(o,{id:a?.id,parent:e.self,syncSnapshot:a?.syncSnapshot,input:a?.input,src:o,systemId:a?.systemId});{let l=(0,n.z)(t,o);if(!l)throw Error(`Actor logic '${o}' not implemented in machine '${t.id}'`);let c=(0,n.A)(l,{id:a?.id,parent:e.self,syncSnapshot:a?.syncSnapshot,input:"function"==typeof a?.input?a.input({context:r,event:s,self:e.self}):a?.input,src:o,systemId:a?.systemId});return i[c.id]=c,c}};return(t,r)=>{let s=o(t,r);return i[s.id]=s,e.defer(()=>{s._processingStatus!==n.T.Stopped&&s.start()}),s}}(e,t,r.event,o),self:e.self,system:e.system},l={};if("function"==typeof i)l=i(a,s);else for(let e of Object.keys(i)){let t=i[e];l[e]="function"==typeof t?t(a,s):t}let c=Object.assign({},t.context,l);return[(0,n.U)(t,{context:c,children:Object.keys(o).length?{...t.children,...o}:t.children}),void 0,void 0]}function i(e){function t(e,t){}return t.type="xstate.assign",t.assignment=e,t.resolve=s,t}function o(e,t,r,n,{event:s}){return[t,{event:"function"==typeof s?s(r,n):s},void 0]}function a(e,{event:t}){e.defer(()=>e.emit(t))}let l=function(e){return e.Parent="#_parent",e.Internal="#_internal",e}({});function c(e,t,r,n,{to:s,event:i,id:o,delay:a},c){let u,d,h=t.machine.implementations.delays;if("string"==typeof i)throw Error(`Only event objects may be used with sendTo; use sendTo({ type: "${i}" }) instead`);let p="function"==typeof i?i(r,n):i;if("string"==typeof a){let e=h&&h[a];u="function"==typeof e?e(r,n):e}else u="function"==typeof a?a(r,n):a;let f="function"==typeof s?s(r,n):s;if("string"==typeof f){if(!(d=f===l.Parent?e.self._parent:f===l.Internal?e.self:f.startsWith("#_")?t.children[f.slice(2)]:c.deferredActorIds?.includes(f)?f:t.children[f]))throw Error(`Unable to send event to actor '${f}' from machine '${t.machine.id}'.`)}else d=f||e.self;return[t,{to:d,targetId:"string"==typeof f?f:void 0,event:p,id:o,delay:u},void 0]}function u(e,t,r){"string"==typeof r.to&&(r.to=t.children[r.to])}function d(e,t){e.defer(()=>{let{to:r,event:s,delay:i,id:o}=t;if("number"==typeof i)return void e.system.scheduler.schedule(e.self,r,s,i,o);e.system._relay(e.self,r,s.type===n.V?(0,n.W)(e.self.id,s.data):s)})}function h(e,t,r){function n(e,t){}return n.type="xstate.sendTo",n.to=e,n.event=t,n.id=r?.id,n.delay=r?.delay,n.resolve=c,n.retryResolve=u,n.execute=d,n}function p(e,t){return h(l.Parent,e,t)}function f(e,t,r,s,{collect:l}){let c=[],u=function(e){c.push(e)};return u.assign=(...e)=>{c.push(i(...e))},u.cancel=(...e)=>{c.push((0,n.M)(...e))},u.raise=(...e)=>{c.push((0,n.O)(...e))},u.sendTo=(...e)=>{c.push(h(...e))},u.sendParent=(...e)=>{c.push(p(...e))},u.spawnChild=(...e)=>{c.push((0,n.P)(...e))},u.stopChild=(...e)=>{c.push((0,n.R)(...e))},u.emit=(...e)=>{c.push(function(e){function t(e,t){}return t.type="xstate.emit",t.event=e,t.resolve=o,t.execute=a,t}(...e))},l({context:r.context,event:r.event,enqueue:u,check:e=>(0,n.e)(e,t.context,r.event,t),self:e.self,system:e.system},s),[t,void 0,c]}function m(e){function t(e,t){}return t.type="xstate.enqueueActions",t.collect=e,t.resolve=f,t}function g(e,t,r,n,{value:s,label:i}){return[t,{value:"function"==typeof s?s(r,n):s,label:i},void 0]}function v({logger:e},{value:t,label:r}){r?e(r,t):e(t)}function y(e=({context:e,event:t})=>({context:e,event:t}),t){function r(e,t){}return r.type="xstate.log",r.value=e,r.label=t,r.resolve=g,r.execute=v,r}},1569:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useRouter",{enumerable:!0,get:function(){return i}});let n=r(2115),s=r(901);function i(){return(0,n.useContext)(s.RouterContext)}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},1640:(e,t,r)=>{"use strict";r.d(t,{Wl:()=>tW,jq:()=>eS,X$:()=>eE,Ng:()=>tk,OQ:()=>tq,D0:()=>e2,bg:()=>e5,lV:()=>e4,nF:()=>eR,In:()=>tC,pd:()=>tl,JU:()=>tu,Vu:()=>tH,rX:()=>tB,k3:()=>tX,ew:()=>tY,kj:()=>tK,q3:()=>t$,ii:()=>tG,P6:()=>tV,aB:()=>tj,zD:()=>rA,VF:()=>e7,ND:()=>rh,Mk:()=>rp,DD:()=>rI,pQ:()=>rO,Qi:()=>rP,mR:()=>ry,xm:()=>tx,qk:()=>rV,h7:()=>rY,Yj:()=>rW,pz:()=>rB,XT:()=>td,tX:()=>ri,AG:()=>rs,VK:()=>ev,S7:()=>eg,OV:()=>ey,Ye:()=>t4,Nn:()=>n,mn:()=>tz,Y6:()=>ro,BR:()=>tp,xt:()=>eA,hD:()=>tO,L:()=>to});var n,s=r(2115),i=r.t(s,2);function o(e,t,{checkForDefaultPrevented:r=!0}={}){return function(n){if(e?.(n),!1===r||!n.defaultPrevented)return t?.(n)}}var a=r(6101),l=r(5155),c=globalThis?.document?s.useLayoutEffect:()=>{},u=i[" useId ".trim().toString()]||(()=>void 0),d=0;function h(e){let[t,r]=s.useState(u());return c(()=>{e||r(e=>e??String(d++))},[e]),e||(t?`radix-${t}`:"")}r(7650);var p=r(9708),f=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,p.TL)(`Primitive.${t}`),n=s.forwardRef((e,n)=>{let{asChild:s,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(s?r:t,{...i,ref:n})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),m=s.forwardRef((e,t)=>(0,l.jsx)(f.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null==(r=e.onMouseDown)||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));m.displayName="Label";var[g,v]=function(e,t=[]){let r=[],n=()=>{let t=r.map(e=>s.createContext(e));return function(r){let n=r?.[e]||t;return s.useMemo(()=>({[`__scope${e}`]:{...r,[e]:n}}),[r,n])}};return n.scopeName=e,[function(t,n){let i=s.createContext(n),o=r.length;r=[...r,n];let a=t=>{let{scope:r,children:n,...a}=t,c=r?.[e]?.[o]||i,u=s.useMemo(()=>a,Object.values(a));return(0,l.jsx)(c.Provider,{value:u,children:n})};return a.displayName=t+"Provider",[a,function(r,a){let l=a?.[e]?.[o]||i,c=s.useContext(l);if(c)return c;if(void 0!==n)return n;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let n=r.reduce((t,{useScope:r,scopeName:n})=>{let s=r(e)[`__scope${n}`];return{...t,...s}},{});return s.useMemo(()=>({[`__scope${t.scopeName}`]:n}),[n])}};return r.scopeName=t.scopeName,r}(n,...t)]}("Form"),y="Form",[_,S]=g(y),[E,x]=g(y),T=s.forwardRef((e,t)=>{let{__scopeForm:r,onClearServerErrors:n=()=>{},...i}=e,c=s.useRef(null),u=(0,a.s)(t,c),[d,h]=s.useState({}),p=s.useCallback(e=>d[e],[d]),m=s.useCallback((e,t)=>h(r=>{var n;return{...r,[e]:{...null!=(n=r[e])?n:{},...t}}}),[]),g=s.useCallback(e=>{h(t=>({...t,[e]:void 0})),b(t=>({...t,[e]:{}}))},[]),[v,y]=s.useState({}),S=s.useCallback(e=>{var t;return null!=(t=v[e])?t:[]},[v]),x=s.useCallback((e,t)=>{y(r=>{var n;return{...r,[e]:[...null!=(n=r[e])?n:[],t]}})},[]),T=s.useCallback((e,t)=>{y(r=>{var n;return{...r,[e]:(null!=(n=r[e])?n:[]).filter(e=>e.id!==t)}})},[]),[w,b]=s.useState({}),R=s.useCallback(e=>{var t;return null!=(t=w[e])?t:{}},[w]),A=s.useCallback((e,t)=>{b(r=>{var n;return{...r,[e]:{...null!=(n=r[e])?n:{},...t}}})},[]),[I,k]=s.useState({}),C=s.useCallback((e,t)=>{k(r=>{let n=new Set(r[e]).add(t);return{...r,[e]:n}})},[]),P=s.useCallback((e,t)=>{k(r=>{let n=new Set(r[e]);return n.delete(t),{...r,[e]:n}})},[]),N=s.useCallback(e=>{var t;return Array.from(null!=(t=I[e])?t:[]).join(" ")||void 0},[I]);return(0,l.jsx)(_,{scope:r,getFieldValidity:p,onFieldValidityChange:m,getFieldCustomMatcherEntries:S,onFieldCustomMatcherEntryAdd:x,onFieldCustomMatcherEntryRemove:T,getFieldCustomErrors:R,onFieldCustomErrorsChange:A,onFieldValiditionClear:g,children:(0,l.jsx)(E,{scope:r,onFieldMessageIdAdd:C,onFieldMessageIdRemove:P,getFieldDescription:N,children:(0,l.jsx)(f.form,{...i,ref:u,onInvalid:o(e.onInvalid,e=>{let t=K(e.currentTarget);t===e.target&&t.focus(),e.preventDefault()}),onSubmit:o(e.onSubmit,n,{checkForDefaultPrevented:!1}),onReset:o(e.onReset,n)})})})});T.displayName=y;var w="FormField",[b,R]=g(w),A=s.forwardRef((e,t)=>{let{__scopeForm:r,name:n,serverInvalid:s=!1,...i}=e,o=S(w,r).getFieldValidity(n),a=h();return(0,l.jsx)(b,{scope:r,id:a,name:n,serverInvalid:s,children:(0,l.jsx)(f.div,{"data-valid":W(o,s),"data-invalid":q(o,s),...i,ref:t})})});A.displayName=w;var I="FormLabel",k=s.forwardRef((e,t)=>{let{__scopeForm:r,...n}=e,s=S(I,r),i=R(I,r),o=n.htmlFor||i.id,a=s.getFieldValidity(i.name);return(0,l.jsx)(m,{"data-valid":W(a,i.serverInvalid),"data-invalid":q(a,i.serverInvalid),...n,ref:t,htmlFor:o})});k.displayName=I;var C="FormControl",P=s.forwardRef((e,t)=>{let{__scopeForm:r,...n}=e,i=S(C,r),c=R(C,r),u=x(C,r),d=s.useRef(null),h=(0,a.s)(t,d),p=n.name||c.name,m=n.id||c.id,g=i.getFieldCustomMatcherEntries(p),{onFieldValidityChange:v,onFieldCustomErrorsChange:y,onFieldValiditionClear:_}=i,E=s.useCallback(async e=>{if(X(e.validity))return void v(p,$(e.validity));let t=e.form?new FormData(e.form):new FormData,r=[e.value,t],n=[],s=[];g.forEach(e=>{!function(e,t){var r;return"AsyncFunction"===e.match.constructor.name||(r=e.match,r(...t)instanceof Promise)}(e,r)?"Function"===e.match.constructor.name&&n.push(e):s.push(e)});let i=Object.fromEntries(n.map(e=>{let{id:t,match:n}=e;return[t,n(...r)]})),o=Object.values(i).some(Boolean);if(e.setCustomValidity(o?N:""),v(p,$(e.validity)),y(p,i),!o&&s.length>0){let t=s.map(e=>{let{id:t,match:n}=e;return n(...r).then(e=>[t,e])}),n=Object.fromEntries(await Promise.all(t)),i=Object.values(n).some(Boolean);e.setCustomValidity(i?N:""),v(p,$(e.validity)),y(p,n)}},[g,p,y,v]);s.useEffect(()=>{let e=d.current;if(e){let t=()=>E(e);return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}},[E]);let T=s.useCallback(()=>{let e=d.current;e&&(e.setCustomValidity(""),_(p))},[p,_]);s.useEffect(()=>{var e;let t=null==(e=d.current)?void 0:e.form;if(t)return t.addEventListener("reset",T),()=>t.removeEventListener("reset",T)},[T]),s.useEffect(()=>{let e=d.current,t=null==e?void 0:e.closest("form");if(t&&c.serverInvalid){let r=K(t);r===e&&r.focus()}},[c.serverInvalid]);let w=i.getFieldValidity(p);return(0,l.jsx)(f.input,{"data-valid":W(w,c.serverInvalid),"data-invalid":q(w,c.serverInvalid),"aria-invalid":!!c.serverInvalid||void 0,"aria-describedby":u.getFieldDescription(p),title:"",...n,ref:h,id:m,name:p,onInvalid:o(e.onInvalid,e=>{E(e.currentTarget)}),onChange:o(e.onChange,e=>{T()})})});P.displayName=C;var N="This value is not valid",L={badInput:N,patternMismatch:"This value does not match the required pattern",rangeOverflow:"This value is too large",rangeUnderflow:"This value is too small",stepMismatch:"This value does not match the required step",tooLong:"This value is too long",tooShort:"This value is too short",typeMismatch:"This value does not match the required type",valid:void 0,valueMissing:"This value is missing"},M="FormMessage",F=s.forwardRef((e,t)=>{let{match:r,name:n,...s}=e,i=R(M,e.__scopeForm),o=null!=n?n:i.name;return void 0===r?(0,l.jsx)(D,{...s,ref:t,name:o,children:e.children||N}):"function"==typeof r?(0,l.jsx)(U,{match:r,...s,ref:t,name:o}):(0,l.jsx)(O,{match:r,...s,ref:t,name:o})});F.displayName=M;var O=s.forwardRef((e,t)=>{let{match:r,forceMatch:n=!1,name:s,children:i,...o}=e,a=S(M,o.__scopeForm).getFieldValidity(s);return n||(null==a?void 0:a[r])?(0,l.jsx)(D,{ref:t,...o,name:s,children:null!=i?i:L[r]}):null}),U=s.forwardRef((e,t)=>{let{match:r,forceMatch:n=!1,name:i,id:o,children:c,...u}=e,d=S(M,u.__scopeForm),p=s.useRef(null),f=(0,a.s)(t,p),m=h(),g=null!=o?o:m,v=s.useMemo(()=>({id:g,match:r}),[g,r]),{onFieldCustomMatcherEntryAdd:y,onFieldCustomMatcherEntryRemove:_}=d;s.useEffect(()=>(y(i,v),()=>_(i,v.id)),[v,i,y,_]);let E=d.getFieldValidity(i),x=d.getFieldCustomErrors(i)[g];return n||E&&!X(E)&&x?(0,l.jsx)(D,{id:g,ref:f,...u,name:i,children:null!=c?c:N}):null}),D=s.forwardRef((e,t)=>{let{__scopeForm:r,id:n,name:i,...o}=e,a=x(M,r),c=h(),u=null!=n?n:c,{onFieldMessageIdAdd:d,onFieldMessageIdRemove:p}=a;return s.useEffect(()=>(d(i,u),()=>p(i,u)),[i,u,d,p]),(0,l.jsx)(f.span,{id:u,...o,ref:t})}),j="FormValidityState",H=e=>{let{__scopeForm:t,name:r,children:n}=e,s=S(j,t),i=R(j,t),o=null!=r?r:i.name,a=s.getFieldValidity(o);return(0,l.jsx)(l.Fragment,{children:n(a)})};H.displayName=j;var V=s.forwardRef((e,t)=>{let{__scopeForm:r,...n}=e;return(0,l.jsx)(f.button,{type:"submit",...n,ref:t})});function $(e){let t={};for(let r in e)t[r]=e[r];return t}function G(e){return e instanceof HTMLElement}function B(e){return"validity"in e&&(!1===e.validity.valid||"true"===e.getAttribute("aria-invalid"))}function K(e){let[t]=Array.from(e.elements).filter(G).filter(B);return t}function X(e){let t=!1;for(let r in e)if("valid"!==r&&"customError"!==r&&e[r]){t=!0;break}return t}function W(e,t){if((null==e?void 0:e.valid)===!0&&!t)return!0}function q(e,t){if((null==e?void 0:e.valid)===!1||t)return!0}V.displayName="FormSubmit";var Y=r(2070),z=r(3789),J=r(4579),Q=r(208),Z=r(1454),ee=r(8845),et=r(8416),er=r(2459),en=r(6898),es=r(2163);r(5649);var ei=[{provider:"google",strategy:"oauth_google",name:"Google",docsUrl:"https://clerk.com/docs/authentication/social-connections/google"},{provider:"discord",strategy:"oauth_discord",name:"Discord",docsUrl:"https://clerk.com/docs/authentication/social-connections/discord"},{provider:"facebook",strategy:"oauth_facebook",name:"Facebook",docsUrl:"https://clerk.com/docs/authentication/social-connections/facebook"},{provider:"twitch",strategy:"oauth_twitch",name:"Twitch",docsUrl:"https://clerk.com/docs/authentication/social-connections/twitch"},{provider:"twitter",strategy:"oauth_twitter",name:"Twitter",docsUrl:"https://clerk.com/docs/authentication/social-connections/twitter"},{provider:"microsoft",strategy:"oauth_microsoft",name:"Microsoft",docsUrl:"https://clerk.com/docs/authentication/social-connections/microsoft"},{provider:"tiktok",strategy:"oauth_tiktok",name:"TikTok",docsUrl:"https://clerk.com/docs/authentication/social-connections/tiktok"},{provider:"linkedin",strategy:"oauth_linkedin",name:"LinkedIn",docsUrl:"https://clerk.com/docs/authentication/social-connections/linkedin"},{provider:"linkedin_oidc",strategy:"oauth_linkedin_oidc",name:"LinkedIn",docsUrl:"https://clerk.com/docs/authentication/social-connections/linkedin-oidc"},{provider:"github",strategy:"oauth_github",name:"GitHub",docsUrl:"https://clerk.com/docs/authentication/social-connections/github"},{provider:"gitlab",strategy:"oauth_gitlab",name:"GitLab",docsUrl:"https://clerk.com/docs/authentication/social-connections/gitlab"},{provider:"dropbox",strategy:"oauth_dropbox",name:"Dropbox",docsUrl:"https://clerk.com/docs/authentication/social-connections/dropbox"},{provider:"atlassian",strategy:"oauth_atlassian",name:"Atlassian",docsUrl:"https://clerk.com/docs/authentication/social-connections/atlassian"},{provider:"bitbucket",strategy:"oauth_bitbucket",name:"Bitbucket",docsUrl:"https://clerk.com/docs/authentication/social-connections/bitbucket"},{provider:"hubspot",strategy:"oauth_hubspot",name:"HubSpot",docsUrl:"https://clerk.com/docs/authentication/social-connections/hubspot"},{provider:"notion",strategy:"oauth_notion",name:"Notion",docsUrl:"https://clerk.com/docs/authentication/social-connections/notion"},{provider:"apple",strategy:"oauth_apple",name:"Apple",docsUrl:"https://clerk.com/docs/authentication/social-connections/apple"},{provider:"line",strategy:"oauth_line",name:"LINE",docsUrl:"https://clerk.com/docs/authentication/social-connections/line"},{provider:"instagram",strategy:"oauth_instagram",name:"Instagram",docsUrl:"https://clerk.com/docs/authentication/social-connections/instagram"},{provider:"coinbase",strategy:"oauth_coinbase",name:"Coinbase",docsUrl:"https://clerk.com/docs/authentication/social-connections/coinbase"},{provider:"spotify",strategy:"oauth_spotify",name:"Spotify",docsUrl:"https://clerk.com/docs/authentication/social-connections/spotify"},{provider:"xero",strategy:"oauth_xero",name:"Xero",docsUrl:"https://clerk.com/docs/authentication/social-connections/xero"},{provider:"box",strategy:"oauth_box",name:"Box",docsUrl:"https://clerk.com/docs/authentication/social-connections/box"},{provider:"slack",strategy:"oauth_slack",name:"Slack",docsUrl:"https://clerk.com/docs/authentication/social-connections/slack"},{provider:"linear",strategy:"oauth_linear",name:"Linear",docsUrl:"https://clerk.com/docs/authentication/social-connections/linear"},{provider:"x",strategy:"oauth_x",name:"X / Twitter",docsUrl:"https://clerk.com/docs/authentication/social-connections/x-twitter-v2"},{provider:"enstall",strategy:"oauth_enstall",name:"Enstall",docsUrl:"https://clerk.com/docs/authentication/social-connections/enstall"},{provider:"huggingface",strategy:"oauth_huggingface",name:"Hugging Face",docsUrl:"https://clerk.com/docs/authentication/social-connections/huggingface"}],eo=[{provider:"metamask",strategy:"web3_metamask_signature",name:"MetaMask"},{provider:"coinbase_wallet",strategy:"web3_coinbase_wallet_signature",name:"Coinbase Wallet"},{provider:"okx_wallet",strategy:"web3_okx_wallet_signature",name:"OKX Wallet"}],ea=r(898),el=r(8679);function ec(){return(0,el.F7)()&&"function"==typeof window.PublicKeyCredential}async function eu(){try{return ec()&&await window.PublicKeyCredential.isConditionalMediationAvailable()}catch{return!1}}var ed=r(5732),eh=r(9733);r(3200);var ep=r(9509),ef=e=>{throw TypeError(e)},em=(e,t,r)=>t.has(e)||ef("Cannot "+r),eg=(e,t,r)=>(em(e,t,"read from private field"),r?r.call(e):t.get(e)),ev=(e,t,r)=>t.has(e)?ef("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),ey=(e,t,r,n)=>(em(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),e_=class extends Error{constructor(e,t){super(t),this.code=e,this.clerkError=!0,this.clerkElementsError=!0,this.name="ClerkElementsError",this.rawMessage=t}toString(){return`[${this.name}]
Code: ${this.code}
Message: ${this.message}`}},eS=class e extends e_{static fromAPIError(t){return new e(t.code.toString(),t.longMessage||t.message)}constructor(e,t){super(e,t),this.name="ClerkElementsError"}},eE=class extends e_{constructor(e){super("elements_runtime_error",e),this.name="ClerkElementsRuntimeError"}},ex=class e extends e_{constructor(e,t){super(e,t),this.matchFn=()=>!0,this.name="ClerkElementsFieldError"}static fromAPIError(t){return new e(t.code,t.longMessage||t.message)}get validityState(){return this.code}get forceMatch(){return!0}},eT=(0,Q.mj)({actions:{setGlobalErrors:(0,Z.a)({errors:(e,t)=>[...t.errors]}),setFieldFeedback:(0,Z.a)({fields:({context:e},t)=>{if(!t.name)throw Error("Field name is required");let r=t.name;return e.fields.has(r)&&(e.fields.get(r).feedback=t.feedback),e.fields}})},types:{}}).createMachine({id:"Form",context:()=>({defaultValues:new Map,errors:[],fields:new Map,progressive:!1}),on:{"ERRORS.SET":{actions:(0,Z.b)(({enqueue:e,event:t})=>{var r,n,s;let i=e=>"meta"in e;if((0,z.ux)(t.error)){let o={},a=[];for(let e of(0,z.$R)(t.error)?null==(r=t.error)?void 0:r.errors:[t.error]){let t=i(e)?(0,J.sF)(null==(n=e.meta)?void 0:n.paramName):null;if(!t||(0,z.si)(e)){a.push(eS.fromAPIError(e));continue}o[t]||(o[t]=[]),null==(s=o[t])||s.push(ex.fromAPIError(e))}for(let t in e({type:"setGlobalErrors",params:{errors:a}}),o)e({type:"setFieldFeedback",params:{name:t,feedback:{type:"error",message:o[t][0]}}})}})},"ERRORS.CLEAR":{actions:(0,Z.a)({errors:()=>[]})},"FIELD.ADD":{actions:(0,Z.a)({fields:({context:e,event:t})=>{if(!t.field.name)throw Error("Field name is required");return t.field.value=t.field.value||e.defaultValues.get(t.field.name)||void 0,e.fields.set(t.field.name,t.field),e.fields}})},"FIELD.UPDATE":{actions:(0,Z.a)({fields:({context:e,event:t})=>{var r;if(!t.field.name)throw Error("Field name is required");let n=e.fields.get(t.field.name);return n&&(n.checked=t.field.checked,n.disabled=null!=(r=t.field.disabled)?r:n.disabled,n.value=t.field.value,e.fields.set(t.field.name,n)),e.fields}})},"FIELD.DISABLE":{actions:(0,Z.a)({fields:({context:e,event:t})=>{if(!t.field.name)throw Error("Field name is required");let r=e.fields.get(t.field.name);return r&&(r.disabled=!0,e.fields.set(t.field.name,r)),e.fields}})},"FIELD.ENABLE":{actions:(0,Z.a)({fields:({context:e,event:t})=>{if(!t.field.name)throw Error("Field name is required");let r=e.fields.get(t.field.name);return r&&(r.disabled=!1,e.fields.set(t.field.name,r)),e.fields}})},"FIELD.REMOVE":{actions:(0,Z.a)({fields:({context:e,event:t})=>{if(!t.field.name)throw Error("Field name is required");return e.fields.delete(t.field.name),e.fields}})},"FIELD.FEEDBACK.SET":{actions:[{type:"setFieldFeedback",params:({event:e})=>e.field}]},"FIELD.FEEDBACK.CLEAR":{actions:(0,Z.a)({fields:({context:e,event:t})=>{if(!t.field.name)throw Error("Field name is required");return e.fields.has(t.field.name)&&(e.fields.get(t.field.name).feedback=void 0),e.fields}})},"FIELD.FEEDBACK.CLEAR.ALL":{actions:(0,Z.a)({fields:({context:e})=>(e.fields.forEach(e=>{e.feedback=void 0}),e.fields)})},MARK_AS_PROGRESSIVE:{actions:(0,Z.a)(({event:e})=>{let t=new Set(e.missing);return{defaultValues:e.defaultValues,hidden:new Set([...e.required.filter(e=>!t.has(e)),...e.optional]),missing:t,optional:new Set(e.optional),progressive:!0,required:new Set(e.required)}})},UNMARK_AS_PROGRESSIVE:{actions:(0,Z.a)({defaultValues:new Map,hidden:void 0,missing:void 0,optional:void 0,progressive:!1,required:void 0})},PREFILL_DEFAULT_VALUES:{actions:(0,Z.a)(({event:e})=>({defaultValues:e.defaultValues}))}}});function ew(e,t){try{return e()}catch{return t}}var eb=(0,Y.jv)(eT,{inspect:n}),eR=eb.Provider,eA=eb.useActorRef,eI=eb.useSelector,ek=e=>e.context.errors,eC=e=>t=>{var r;return e?null==(r=t.context.fields.get(e))?void 0:r.value:""},eP=e=>t=>!!eC(e)(t),eN=e=>t=>{var r;return e?null==(r=t.context.fields.get(e))?void 0:r.feedback:void 0};function eL({name:e}){return{feedback:eI(eN(e))}}var eM=s.createContext(null),eF=()=>s.useContext(eM),eO={success:"success",error:"error",idle:"idle",warning:"warning",info:"info"};function eU({name:e}){let{feedback:t}=eL({name:e}),r=eI(eP(e)),n=eO.idle;switch(!r&&(n=eO.idle),null==t?void 0:t.type){case"error":n=eO.error;break;case"warning":n=eO.warning;break;case"info":n=eO.info;break;case"success":n=eO.success}return{state:n}}function eD(){return{errors:eI(ek)}}var ej={max_length:["less than %length% characters","length"],min_length:["%length% or more characters","length"],require_numbers:"a number",require_lowercase:"a lowercase letter",require_uppercase:"an uppercase letter",require_special_char:"a special character"},eH=e=>{let t;return"ListFormat"in Intl?new Intl.ListFormat("en",{style:"long",type:"conjunction"}).format(e):e.join(", ")},eV=({config:e,failedValidations:t})=>{let r=[];if(!t||0===Object.keys(t).length)return{codes:r,message:""};let n=(null==t?void 0:t.min_length)||!1,s=eH(Object.entries(t).filter(e=>!n||"min_length"===e[0]).filter(([,e])=>!!e).map(([t])=>{let n=function(e,t){switch(e){case"max_length":return[e,{max_length:t.max_length}];case"min_length":return[e,{min_length:t.min_length}];case"require_special_char":return[e,{allowed_special_characters:t.allowed_special_characters}];default:return e}}(t,e);r.push(n);let s=ej[t];if(Array.isArray(s)){let[r,n]=s;return r.replace(`%${n}%`,e[t])}return s}));return{codes:r,message:`Your password must contain ${s}.`}},e$=e=>{var t;let r=(0,ee.ho)(),{disable_hibp:n,min_zxcvbn_strength:i,show_zxcvbn:o,...a}=(null==(t=r.__unstable__environment)?void 0:t.userSettings.passwordSettings)||{},{onValidationError:l=et.lQ,onValidationSuccess:c=et.lQ,onValidationWarning:u=et.lQ,onValidationInfo:d=et.lQ,onValidationComplexity:h}=e||{},p=s.useCallback(e=>{var t,r,n;if(e.complexity&&Object.values(null==e?void 0:e.complexity).length>0){let{message:r,codes:n}=eV({config:a,failedValidations:e.complexity});return(null==(t=e.complexity)?void 0:t.min_length)?d(r,n):l(r,n)}if((null==(r=null==e?void 0:e.strength)?void 0:r.state)==="fail"){let t=e.strength.keys;return l(JSON.stringify(t),t)}if((null==(n=null==e?void 0:e.strength)?void 0:n.state)==="pass"){let t=e.strength.keys;return u(JSON.stringify(t),t)}return c()},[e,a]);return{validatePassword:s.useMemo(()=>e=>r.client.signUp.validatePassword(e,{onValidation:p,onValidationComplexity:h}),[p])}},eG=[0,0],eB=[-1,-1],eK=s.forwardRef(function(e,t){let{render:r,length:n,autoSubmit:s,...i}=e;return void 0!==r?(0,l.jsx)(eW,{...i,ref:t,render:r,length:n,autoSubmit:s}):(0,l.jsx)(eX,{...i,ref:t,length:n,autoSubmit:s})}),eX=s.forwardRef(function(e,t){let{length:r=6,autoSubmit:n=!1,...i}=e,o=s.useRef(null);return s.useImperativeHandle(t,()=>o.current,[]),s.useEffect(()=>{var t,s;String(e.value).length===r&&n&&(null==(s=null==(t=o.current)?void 0:t.form)||s.requestSubmit())},[e.value,r,n]),(0,l.jsx)(P,{ref:o,...i,"data-otp-input-standard":!0})}),eW=s.forwardRef(function(e,t){let{className:r,render:n,length:i=6,autoSubmit:o=!1,passwordManagerOffset:a=40,...c}=e,u=s.useRef(null),[d,h]=s.useState(e.autoFocus?eG:eB),[p,f]=s.useState(!1),m=()=>document.activeElement===u.current;return s.useImperativeHandle(t,()=>u.current,[]),s.useLayoutEffect(()=>{document.activeElement===u.current&&h(e=>eq(e,u))},[e.value]),s.useEffect(()=>{function e(){m()&&h(e=>eq(e,u))}return document.addEventListener("selectionchange",e,{capture:!0}),()=>document.removeEventListener("selectionchange",e)},[]),s.useEffect(()=>{var t,r;String(e.value).length===i&&o&&(null==(r=null==(t=u.current)?void 0:t.form)||r.requestSubmit())},[e.value,i,o]),(0,l.jsxs)("div",{"data-otp-input-wrapper":!0,style:eY,children:[(0,l.jsx)("style",{children:`
      input[data-otp-input-segmented]::selection {
        color: transparent;
        background-color: transparent;
      }
      `}),(0,l.jsx)(P,{"data-otp-input-segmented":!0,ref:u,...c,onFocus:e=>{var t;if(u.current){let e=Math.min(u.current.value.length,i-1),t=u.current.value.length;u.current.setSelectionRange(e,t),h([e,t])}null==(t=null==c?void 0:c.onFocus)||t.call(c,e)},onBlur:e=>{var t;h([-1,-1]),null==(t=null==c?void 0:c.onBlur)||t.call(c,e)},onMouseOver:t=>{var r;m()||f(!0),null==(r=e.onMouseOver)||r.call(e,t)},onMouseLeave:t=>{var r;f(!1),null==(r=e.onMouseLeave)||r.call(e,t)},style:{...ez,clipPath:`inset(0 calc(1ch + ${a}px) 0 0)`,width:`calc(100% + 1ch + ${a}px)`}}),(0,l.jsx)("div",{className:r,"aria-hidden":!0,style:eJ,children:Array.from({length:i}).map((t,r)=>{var i,o;let a=p&&!m(),c=d[0]===d[1]&&d[0]===r,u=(null!=(i=d[0])?i:-1)<=r&&(null!=(o=d[1])?o:-1)>r;return(0,l.jsx)(s.Fragment,{children:n({value:String(e.value)[r]||"",status:a?"hovered":c?"cursor":u?"selected":"none",index:r})},`otp-segment-${r}`)})})]})});function eq(e,t){var r,n,s,i,o,a,l,c,u;let d=[null!=(n=null==(r=t.current)?void 0:r.selectionStart)?n:0,null!=(i=null==(s=t.current)?void 0:s.selectionEnd)?i:0,null!=(a=null==(o=t.current)?void 0:o.selectionDirection)?a:null];return e[0]===d[0]&&e[1]===d[1]?e:(0===d[0]&&1===d[1]&&(d[2]="forward"),d[0]===d[1]&&(d[0]>0&&e[0]===d[0]&&e[1]===d[0]+1?d=[d[0]-1,d[1],"backward"]:void 0!==(null==(l=t.current)?void 0:l.value[d[0]])?d=[d[0],d[1]+1,"backward"]:d[0]>=6&&(d=[d[0]-1,d[1],"backward"])),null==(u=t.current)||u.setSelectionRange(d[0],d[1],null!=(c=d[2])?c:void 0),[d[0],d[1]])}var eY={position:"relative",userSelect:"none"},ez={display:"block",background:"transparent",opacity:0,outline:"transparent solid 0px",appearance:"none",color:"transparent",position:"absolute",inset:0,caretColor:"transparent",border:"0px solid transparent",height:"100%",letterSpacing:"-1rem"},eJ={zIndex:1,pointerEvents:"none"};function eQ(e,t){return(null==e?void 0:e.valid)===!1?eO.error:t}var eZ=s.createContext(void 0),e0=()=>s.useContext(eZ);function e1({name:e,value:t,checked:r,onChange:n,onBlur:i,onFocus:o,type:a,...l}){let c=eF(),u=e||(null==c?void 0:c.name),d="backup_code"===u?"code":u,{state:h}=eU({name:d}),p=e0();if(!u||!d)throw Error("Clerk: <Input /> must be wrapped in a <Field> component or have a name prop.");let f=eA(),[m,g]=s.useState(!1),{validatePassword:v}=e$({onValidationComplexity:e=>g(e),onValidationSuccess:()=>{f.send({type:"FIELD.FEEDBACK.SET",field:{name:d,feedback:{type:"success",message:"Your password meets all the necessary requirements."}}})},onValidationError:(e,t)=>{e&&f.send({type:"FIELD.FEEDBACK.SET",field:{name:d,feedback:{type:"error",message:new ex("password-validation-error",e),codes:t}}})},onValidationWarning:(e,t)=>f.send({type:"FIELD.FEEDBACK.SET",field:{name:d,feedback:{type:"warning",message:e,codes:t}}}),onValidationInfo:(e,t)=>{f.send({type:"FIELD.FEEDBACK.SET",field:{name:d,feedback:{type:"info",message:e,codes:t}}})}}),y=eI(eC(d)),_=function(e){let t=s.useRef();return s.useEffect(()=>{t.current=e},[e]),t.current}(y),S=!!y,E=null!=a?a:"password"===u||"confirmPassword"===u||"currentPassword"===u||"newPassword"===u?"password":"emailAddress"===u?"email":"phoneNumber"===u?"tel":"code"===u?"otp":"backup_code"===u?"backup_code":"text",x=E,T=!1;("password"===E||"text"===E)&&(T=!!l.validatePassword),("otp"===x||"backup_code"===x)&&(x="text"),s.useEffect(()=>{if(d)return f.send({type:"FIELD.ADD",field:{name:d,type:x,value:t,checked:r}}),()=>f.send({type:"FIELD.REMOVE",field:{name:d}})},[f]),s.useEffect(()=>{d&&("checkbox"===E&&void 0!==r||"checkbox"!==E&&void 0!==t)&&f.send({type:"FIELD.UPDATE",field:{name:d,value:t,checked:r}})},[d,E,f,t,r]);let w=s.useCallback(e=>{null==n||n(e),d&&(f.send({type:"FIELD.UPDATE",field:{name:d,value:e.target.value,checked:e.target.checked}}),T&&v(e.target.value))},[f,d,n,T,v]),b=s.useCallback(e=>{null==i||i(e),T&&e.target.value!==_&&v(e.target.value)},[i,T,v,_]),R=s.useCallback(e=>{null==o||o(e),T&&e.target.value!==_&&v(e.target.value)},[o,T,v,_]),A="otp"===E?eK:P,I={};if("otp"===E){let e=l.length||6;I={"data-otp-input":!0,autoComplete:"one-time-code",inputMode:"numeric",pattern:`[0-9]{${e}}`,minLength:e,maxLength:e,onChange:e=>{e.currentTarget.value=e.currentTarget.value.replace(/\D+/g,""),w(e)},type:"text",spellCheck:!1}}else"backup_code"===E?I={autoComplete:"off",type:"text",spellCheck:!1}:"password"===E&&T&&(I={"data-has-passed-validation":!!m||void 0});let{validatePassword:k,...C}=l;return{Element:A,props:{type:E,value:null!=y?y:"",onChange:w,onBlur:b,onFocus:R,"data-hidden":void 0,"data-has-value":!!S||void 0,"data-state":eQ(p,h),...I,...C}}}var e2=s.forwardRef(({alwaysShow:e,...t},r)=>{var n;let s=eA().getSnapshot().context,i=s.progressive&&!!(null==(n=s.hidden)?void 0:n.has(t.name));return!e&&i?null:(0,l.jsx)(eM.Provider,{value:{name:t.name},children:(0,l.jsx)(e3,{...t,ref:r})})});e2.displayName="ClerkElementsField";var e3=s.forwardRef((e,t)=>{let{children:r,...n}=e,s=function({name:e}){let t=eI(eP(e)),{feedback:r}=eL({name:e});return{hasValue:t,props:{"data-hidden":void 0,serverInvalid:!!r&&"error"===r.type}}}({name:n.name}),{state:i}=eU({name:n.name});return(0,l.jsx)(A,{...s.props,...n,ref:t,children:(0,l.jsx)(H,{children:e=>{let t=eQ(e,i);return(0,l.jsx)(eZ.Provider,{value:e,children:"function"==typeof r?r(t):r})}})})});function e9(e){return s.isValidElement(e)&&e.type===s.Fragment}e3.displayName="ClerkElementsFieldInner";var e5=s.forwardRef(({asChild:e=!1,children:t,code:r,name:n,...s},i)=>{let o=eF(),a=(null==o?void 0:o.name)||n,{feedback:c}=eL({name:"backup_code"===a?"code":a});if((null==c?void 0:c.type)!=="error")return null;let u=c.message;if(!u)return null;let d=e?p.DX:"span",h="function"==typeof t?t(u):t;if(e9(h))throw new eE("<FieldError /> cannot render a Fragment as a child.");return(0,l.jsx)(F,{"data-error-code":u.code,...s,ref:i,asChild:!0,children:(0,l.jsx)(d,{children:h||u.message})})});e5.displayName="ClerkElementsFieldError";var e4=s.forwardRef(({flowActor:e,onSubmit:t,...r},n)=>{let{onSubmit:i,...a}=function({flowActor:e}){let{errors:t}=eD(),r=(0,s.useCallback)(t=>{t.preventDefault(),e&&e.send({type:"SUBMIT",action:"submit"})},[e]);return{props:{...t.length>0?{"data-global-error":!0}:{},onSubmit:r}}}({flowActor:e}).props;return(0,l.jsx)(T,{...a,...r,onSubmit:o(i,t),ref:n})});function e6(e){let t=s.createContext(null),r=t.Provider;function n({children:e,actorRef:t}){return s.createElement(r,{value:t},e)}function i(e=!1){let r=s.useContext(t);if(!e&&!r)throw Error(`You used a hook from "${n.displayName}" but it's not inside a <${n.displayName}.Provider> component.`);return r}return n.displayName=e,{Provider:n,useActorRef:i,useSelector:function(e,t){let r=i();return(0,Y.d4)(r,e,t)}}}e4.displayName="ClerkElementsForm",s.forwardRef(({asChild:e=!1,children:t,code:r,...n},s)=>{let{errors:i}=eD(),o=null==i?void 0:i[0];if(!o||r&&o.code!==r)return null;let a=e?p.DX:"div",c="function"==typeof t?t(o):t;if(e9(c))throw new eE("<GlobalError /> cannot render a Fragment as a child.");return(0,l.jsx)(a,{role:"alert",...n,ref:s,children:c||o.message})}).displayName="ClerkElementsGlobalError";var e7=e6("SignInRouterCtx");function e8(e){return e7.useSelector(t=>t.children[e])}var te=()=>e8("start"),tt=()=>e8("firstFactor"),tr=()=>e8("secondFactor"),tn=()=>e8("resetPassword"),ts=()=>e7.useSelector(e=>e.context.webAuthnAutofillSupport),ti=(0,s.createContext)({strategy:void 0});function to(){let e=(0,s.useContext)(ti);if(!e)throw new eE("useSignInStrategy must be used within a <SignIn.Strategy> or <SignIn.SupportedStrategy> component.");let{strategy:t}=e;return t}var ta=(0,s.createContext)({current:void 0,isActive:e=>!1,preferred:void 0}),tl=s.forwardRef((e,t)=>{var r,n,s;let i=(0,ee.ho)(),o=e1(e),a=!!(null==(r=o.props.autoComplete)?void 0:r.includes("webauthn")),c=["text","email","tel"].includes(o.props.type),u=e7.useActorRef(!0);return(null==(s=i.telemetry)||s.record((0,en.we)("Elements_Input",{type:null!=(n=e.type)&&n,render:!!(null==e?void 0:e.render),asChild:!!(null==e?void 0:e.asChild),validatePassword:!!(null==e?void 0:e.validatePassword)})),u&&a&&c)?(0,l.jsx)(tc,{ref:t,...e}):(a&&!c?er.v.warnOnce('<Input autoComplete="webauthn"> can only be used with <Input type="text"> or <Input type="email">'):a&&er.v.warnOnce('<Input autoComplete="webauthn"> can only be used inside <SignIn> in order to trigger a sign-in attempt, otherwise it will be ignored.'),(0,l.jsx)(o.Element,{ref:t,...o.props}))});tl.displayName="ClerkElementsInput";var tc=s.forwardRef((e,t)=>{let r=e7.useActorRef(!0),n=ts();s.useEffect(()=>{n&&(null==r||r.send({type:"AUTHENTICATE.PASSKEY.AUTOFILL"}))},[n,r]);let i=e1(e);return(0,l.jsx)(i.Element,{ref:t,...i.props})});tc.displayName="ClerkElementsInputWithPasskeyAutofill";var tu=k;tu.displayName="ClerkElementsLabel";var td=V;td.displayName="ClerkElementsSubmit";var th={any:"any",all:"all"};function tp(e,t,r=th.any){let n=(0,Y.d4)(e,e=>e,(e,t)=>e.tags===t.tags);if(!n)return!1;if("string"==typeof t)return n.hasTag(t);if(!Array.isArray(t))throw Error("Invalid tags parameter provided to useActiveTags");switch(r){case th.any:{let e=new Set(t.filter(e=>n.hasTag(e)));return{active:e.size>0,activeTags:e}}case th.all:return t.length===n.tags.size&&t.every(e=>n.hasTag(e));default:return!1}}var tf=e=>[...e].reduce((e,[t,r])=>(e[t]=r,e),{}),tm=ei.map(e=>e.strategy),tg=tf([...ei,...eo].map(e=>[e.provider,{iconUrl:(0,es.at)(e.provider),name:e.name,strategy:e.strategy}])),tv=tf([...ei,...eo].map(e=>[e.strategy,{iconUrl:(0,es.at)(e.provider),id:e.provider,name:e.name}])),ty={authenticatableOauthStrategies:[],providerToDisplayData:{},strategies:[],strategyToDisplayData:{},web3Strategies:[]},t_=e=>{if(!(null==e?void 0:e.userSettings))return ty;let{socialProviderStrategies:t,web3FirstFactors:r,authenticatableSocialStrategies:n}=e.userSettings,s=t.filter(e=>tm.includes(e));return{authenticatableOauthStrategies:[...n.filter(e=>tm.includes(e))],providerToDisplayData:tg,strategies:[...s,...r],strategyToDisplayData:tv,web3Strategies:r}},tS=e=>{var t,r,n,s;let i=(0,ee.ho)();if(!i.loaded)return null;if("saml"===e||"enterprise_sso"===e)return null!=(s=null!=(n=null==(t=i.__unstable__environment)?void 0:t.userSettings.saml.enabled)?n:null==(r=i.__unstable__environment)?void 0:r.userSettings.enterpriseSSO.enabled)&&s;let o=t_(i.__unstable__environment);return function(e,t){return t.includes(e.startsWith("oauth_")?e:`oauth_${e}`)}(e,o.authenticatableOauthStrategies)||function(e,t){return t.includes(e.startsWith("web3_")?e:`web3_${e}_signature`)}(e,o.web3Strategies)},tE=(e,t)=>{let r=tS(t),n="saml"===t,i="enterprise_sso"===t,o=i||n?{name:"SSO",strategy:t}:tg[t],a=(0,s.useCallback)(s=>{if(r)return(s.preventDefault(),n)?e.send({type:"AUTHENTICATE.SAML"}):i?e.send({type:"AUTHENTICATE.ENTERPRISE_SSO"}):"metamask"===t?e.send({type:"AUTHENTICATE.WEB3",strategy:"web3_metamask_signature"}):"coinbase_wallet"===t?e.send({type:"AUTHENTICATE.WEB3",strategy:"web3_coinbase_wallet_signature"}):"okx_wallet"===t?e.send({type:"AUTHENTICATE.WEB3",strategy:"web3_okx_wallet_signature"}):e.send({type:"AUTHENTICATE.OAUTH",strategy:`oauth_${t}`})},[t,r,n,i,e]);if(!1===r){let e=`https://dashboard.clerk.com/last-active?path=/user-authentication/${"metamask"===t?"web3":"social-connections"}`;throw new eE(`You have used <Connection name="${t}"> which isn't enabled for your project. Enable ${o.name} in your Clerk dashboard: ${e}`)}return{events:{authenticate:a},...o}},tx=e6("SignUpRouterCtx");function tT(e){return tx.useSelector(t=>t.children[e])}var tw=()=>tT("start"),tb=()=>tT("continue"),tR=()=>tT("verification"),tA=(0,s.createContext)(null),tI=()=>{let e=(0,s.useContext)(tA);if(!e)throw Error("useConnectionContext must be used within <Clerk.Connection>");return e};function tk({asChild:e,name:t,...r}){let n=e7.useActorRef(!0),s=tx.useActorRef(!0),i=tE(n||s,t);if(!i)return null;let o=e?p.DX:"button";return(0,l.jsx)(tA.Provider,{value:i,children:(0,l.jsx)(o,{onClick:i.events.authenticate,...e?{}:{type:"button"},...r})})}function tC({asChild:e,...t}){let{iconUrl:r,name:n}=tI(),s=e?p.DX:"img";return(0,l.jsx)(s,{alt:`${n} logo`,src:r,...t})}var tP=e=>{var t;return null==(t=null==e?void 0:e.context)?void 0:t.loading},tN=(e,t)=>(null==e?void 0:e.isLoading)===(null==t?void 0:t.isLoading);function tL(e){let t=useSelector2(e,tP,tN);return t?[t.isLoading,{step:t.step,strategy:t.strategy,action:t.action}]:[!1,{step:void 0,strategy:void 0,action:void 0}]}function tM(e){let t=s.createContext(!1),r=t.Provider;function n({children:e}){return s.createElement(r,{value:!0},e)}return n.displayName=e,{Provider:n,useDomValidation:function(e=!1){let r=s.useContext(t);if(!e&&!r)throw Error(`You used a hook from "${n.displayName}" but it's not inside a <${n.displayName}.Provider> component.`);return r}}}var tF=s.createContext(null);function tO(){let e=s.useContext(tF);if(!e)throw Error("SignInActiveSessionContext must be used within a SessionList/SignInSessionListItem");return e}var tU=tM("SignInChooseSessionCtx");function tD({asChild:e,children:t,...r}){let n=tp(e7.useActorRef(),"step:choose-session"),s=e?p.DX:"div";return n?(0,l.jsx)(tU.Provider,{children:(0,l.jsx)(s,{...r,children:t})}):null}var tj="/sso-callback",tH="/verify",tV={PUBLIC:"public",RESTRICTED:"restricted"},t$=ew(()=>{var e;return null!=(e=ep.env.CLERK_SIGN_IN_URL)?e:"/sign-in"},"/sign-in"),tG=ew(()=>{var e;return null!=(e=ep.env.CLERK_SIGN_UP_URL)?e:"/sign-up"},"/sign-up"),tB="14.1.0",tK={createdSession:"__clerk_created_session",handshake:"__clerk_handshake",help:"__clerk_help",invitationToken:"__clerk_invitation_token",modalState:"__clerk_modal_state",satelliteUrl:"__clerk_satellite_url",status:"__clerk_status",synced:"__clerk_synced",ticket:"__clerk_ticket",transfer:"__clerk_transfer"},tX=60,tW="clerk-captcha",tq={FORM_IDENTIFIER_NOT_FOUND:"form_identifier_not_found",FORM_PASSWORD_INCORRECT:"form_password_incorrect",INVALID_STRATEGY_FOR_USER:"strategy_for_user_invalid",NOT_ALLOWED_TO_SIGN_UP:"not_allowed_to_sign_up",OAUTH_ACCESS_DENIED:"oauth_access_denied",OAUTH_EMAIL_DOMAIN_RESERVED_BY_SAML:"oauth_email_domain_reserved_by_saml",NOT_ALLOWED_ACCESS:"not_allowed_access",SAML_USER_ATTRIBUTE_MISSING:"saml_user_attribute_missing",USER_LOCKED:"user_locked",ENTERPRISE_SSO_USER_ATTRIBUTE_MISSING:"enterprise_sso_user_attribute_missing",ENTERPRISE_SSO_EMAIL_ADDRESS_DOMAIN_MISMATCH:"enterprise_sso_email_address_domain_mismatch",ENTERPRISE_SSO_HOSTED_DOMAIN_MISMATCH:"enterprise_sso_hosted_domain_mismatch",SAML_EMAIL_ADDRESS_DOMAIN_MISMATCH:"saml_email_address_domain_mismatch",ORGANIZATION_MEMBERSHIP_QUOTA_EXCEEDED_FOR_SSO:"organization_membership_quota_exceeded_for_sso"},tY={path:"path",virtual:"virtual",hash:"hash"};function tz({context:e,event:t}){let r,n,s;return t.type.startsWith("xstate.done.")||t.type.startsWith("xstate.error.")?e.parent.send({type:"LOADING",isLoading:!1,step:void 0,strategy:void 0}):"strategy"===e.loadingStep?(r=void 0,"REDIRECT"===t.type&&(n=t.params.strategy),e.parent.send({type:"LOADING",isLoading:!0,step:r,strategy:n})):"continue"===e.loadingStep?(r="continue",n=void 0,s="action"in t?t.action:void 0,e.parent.send({type:"LOADING",isLoading:!0,step:r,strategy:n,action:s})):"reset-password"===e.loadingStep?(r="reset-password",n=void 0,s="action"in t?t.action:void 0,e.parent.send({type:"LOADING",isLoading:!0,step:r,strategy:n,action:s})):"start"===e.loadingStep?(r="start",n=void 0,s="action"in t?t.action:void 0,e.parent.send({type:"LOADING",isLoading:!0,step:r,strategy:n,action:s})):(r=e.loadingStep,n=void 0,s="action"in t?t.action:void 0,e.parent.send({type:"LOADING",isLoading:!0,step:r,strategy:n,action:s}))}var tJ=e=>e.reduce((e,t,r)=>(e[t]=r,e),{}),tQ=tJ(["passkey","password","email_link","email_code","phone_code"]),tZ=tJ(["email_code","email_link","phone_code","passkey","password"]),t0=e=>(t,r)=>{let n=e[t.strategy],s=e[r.strategy];return void 0===n||void 0===s?0:n-s},t1=t0(tQ),t2=t0(tZ),t3=e=>t=>"safeIdentifier"in t&&t.safeIdentifier===e;function t9(e){if(ec()){let t=e.find(({strategy:e})=>"passkey"===e);if(t)return t}return null}function t5(e,t){if(null==e)throw Error(`${t||e} is not defined`)}function t4(e){if("error"in e==!1)throw Error(`Expected an error event, got "${e.type}"`)}var t6=e=>!!e&&["passkey","password"].includes(e),t7=(0,Q.mj)({actors:{determineStartingFactor:(0,ea.Sx)(()=>Promise.reject(new eE("Actor `determineStartingFactor` must be overridden"))),prepare:(0,ea.Sx)(()=>Promise.reject(new eE("Actor `prepare` must be overridden"))),attempt:(0,ea.Sx)(()=>Promise.reject(new eE("Actor `attempt` must be overridden"))),attemptPasskey:(0,ea.Sx)(({input:{parent:e,flow:t}})=>e.getSnapshot().context.clerk.client.signIn.authenticateWithPasskey({flow:t}))},actions:{resendableTick:(0,Z.a)(({context:e})=>({resendable:0===e.resendableAfter,resendableAfter:e.resendableAfter>0?e.resendableAfter-1:e.resendableAfter})),resendableReset:(0,Z.a)({resendable:!1,resendableAfter:tX}),validateRegisteredStrategies:({context:e})=>{var t;null==(t=e.parent.getSnapshot().context.clerk.__unstable__environment)||t.isProduction()},sendToNext:({context:e,event:t})=>e.parent.send({type:"NEXT",resource:t.output}),sendToLoading:tz,setFormErrors:(0,Z.c)(({context:e})=>e.formRef,({event:e})=>(t4(e),{type:"ERRORS.SET",error:e.error})),setConsoleError:({event:e})=>{}},guards:{isResendable:({context:e})=>e.resendable||0===e.resendableAfter,isNeverResendable:({context:e})=>{var t;return t6(null==(t=e.currentFactor)?void 0:t.strategy)}},delays:{resendableTimeout:1e3},types:{}}).createMachine({id:"SignInVerification",context:({input:e})=>({currentFactor:null,basePath:e.basePath||t$,formRef:e.formRef,loadingStep:"verifications",parent:e.parent,registeredStrategies:new Set,resendable:!1,resendableAfter:tX}),initial:"Init",on:{"NAVIGATE.PREVIOUS":".Hist","STRATEGY.REGISTER":{actions:(0,Z.a)({registeredStrategies:({context:e,event:t})=>e.registeredStrategies.add(t.factor)})},"STRATEGY.UNREGISTER":{actions:(0,Z.a)({registeredStrategies:({context:e,event:t})=>(e.registeredStrategies.delete(t.factor),e.registeredStrategies)})}},states:{Init:{tags:["state:preparing","state:loading"],invoke:{id:"determineStartingFactor",src:"determineStartingFactor",input:({context:e})=>({parent:e.parent}),onDone:{target:"Preparing",actions:(0,Z.a)({currentFactor:({event:e})=>e.output})},onError:{target:"Preparing",actions:[(0,Z.l)("Clerk [Sign In Verification]: Error determining starting factor"),(0,Z.a)({currentFactor:{strategy:"password"}})]}}},Preparing:{tags:["state:preparing","state:loading"],invoke:{id:"prepare",src:"prepare",input:({context:e})=>({parent:e.parent,resendable:e.resendable,params:{...e.currentFactor,redirectUrl:`${window.location.origin}${e.basePath}${tH}`}}),onDone:{actions:"resendableReset",target:"Pending"},onError:{actions:["setFormErrors","setConsoleError"],target:"Pending"}}},Pending:{tags:["state:pending"],description:"Waiting for user input",on:{"AUTHENTICATE.PASSKEY":{target:"AttemptingPasskey",reenter:!0},"NAVIGATE.CHOOSE_STRATEGY":"ChooseStrategy","NAVIGATE.FORGOT_PASSWORD":"ChooseStrategy",RETRY:"Preparing",SUBMIT:{target:"Attempting",reenter:!0}},initial:"Init",states:{Init:{description:"Marks appropriate factors as never resendable.",always:[{guard:"isNeverResendable",target:"NeverResendable"},{target:"NotResendable"}]},Resendable:{description:"Waiting for user to retry"},NeverResendable:{description:"Handles never resendable",on:{RETRY:{actions:(0,Z.l)("Never retriable")}}},NotResendable:{description:"Handle countdowns",on:{RETRY:{actions:(0,Z.l)(({context:e})=>`Not retriable; Try again in ${e.resendableAfter}s`)}},after:{resendableTimeout:[{description:"Set as retriable if countdown is 0",guard:"isResendable",actions:"resendableTick",target:"Resendable"},{description:"Continue countdown if not retriable",actions:"resendableTick",target:"NotResendable",reenter:!0}]}}},after:{3e3:{actions:"validateRegisteredStrategies"}}},ChooseStrategy:{description:"Handles both choose strategy and forgot password as the latter is similar in functionality",tags:["state:choose-strategy","state:forgot-password"],on:{"STRATEGY.UPDATE":{actions:(0,Z.a)({currentFactor:({event:e})=>e.factor||null}),target:"Preparing"}}},Attempting:{tags:["state:attempting","state:loading"],entry:"sendToLoading",invoke:{id:"attempt",src:"attempt",input:({context:e})=>({parent:e.parent,currentFactor:e.currentFactor,fields:e.formRef.getSnapshot().context.fields}),onDone:{actions:["sendToNext","sendToLoading"]},onError:{actions:["setFormErrors","setConsoleError","sendToLoading"],target:"Pending"}}},AttemptingPasskey:{tags:["state:attempting","state:loading"],entry:"sendToLoading",invoke:{id:"attemptPasskey",src:"attemptPasskey",input:({context:e})=>({parent:e.parent,flow:"discoverable"}),onDone:{actions:["sendToNext","sendToLoading"]},onError:{actions:["setFormErrors","sendToLoading"],target:"Pending"}}},Hist:{type:"history"}}}),t8=t7.provide({actors:{determineStartingFactor:(0,ea.Sx)(async({input:e})=>{var t;let r=e.parent.getSnapshot().context.clerk;return Promise.resolve(function(e,t,r){return e&&0!==e.length?"password"===r?function(e,t){let r=t9(e);if(r)return r;let n=e.sort(t1)[0];return"password"===n.strategy?n:e.find(t3(t))||n||null}(e,t):function(e,t){let r=t9(e);if(r)return r;let n=e.sort(t2),s=n.find(t3(t));if(s)return s;let i=n[0];return"email_link"===i.strategy?i:e.find(t3(t))||i||null}(e,t):null}(r.client.signIn.supportedFirstFactors,r.client.signIn.identifier,null==(t=r.__unstable__environment)?void 0:t.displayConfig.preferredSignInStrategy))}),prepare:(0,ea.Sx)(async({input:e})=>{let{params:t,parent:r,resendable:n}=e,s=r.getSnapshot().context.clerk,i=s.client.signIn.firstFactorVerification.expireAt,o=n||!i||i<new Date;return t6(null==t?void 0:t.strategy)||!o?Promise.resolve(s.client.signIn):(t5(t,"First factor params"),await s.client.signIn.prepareFirstFactor(t))}),attempt:(0,ea.Sx)(async({input:e})=>{var t,r,n,s,i;let o,{currentFactor:a,fields:l,parent:c}=e;t5(a,"Current factor");let u=a.strategy,d=null==(t=l.get("code"))?void 0:t.value,h=null==(r=l.get("password"))?void 0:r.value;switch(u){case"passkey":return await c.getSnapshot().context.clerk.client.signIn.authenticateWithPasskey();case"password":t5(h,"Password"),o={strategy:u,password:h};break;case"reset_password_phone_code":case"reset_password_email_code":t5(d,"Code for resetting phone/email"),o={strategy:u,code:d,password:h};break;case"phone_code":case"email_code":t5(d,"Code for phone/email"),o={strategy:u,code:d};break;case"web3_metamask_signature":{let e=null==(n=l.get("signature"))?void 0:n.value;t5(e,"Web3 Metamask signature"),o={strategy:u,signature:e};break}case"web3_coinbase_wallet_signature":{let e=null==(s=l.get("signature"))?void 0:s.value;t5(e,"Web3 Coinbase Wallet signature"),o={strategy:u,signature:e};break}case"web3_okx_wallet_signature":{let e=null==(i=l.get("signature"))?void 0:i.value;t5(e,"Web3 OKX Wallet signature"),o={strategy:u,signature:e};break}default:throw new eE(`Invalid strategy: ${u}`)}return await c.getSnapshot().context.clerk.client.signIn.attemptFirstFactor(o)})}}),re=t7.provide({actors:{determineStartingFactor:(0,ea.Sx)(async({input:e})=>Promise.resolve(function(e){if(!e||0===e.length)return null;let t=e.find(e=>"totp"===e.strategy);if(t)return t;let r=e.find(e=>"phone_code"===e.strategy);return r||e[0]}(e.parent.getSnapshot().context.clerk.client.signIn.supportedSecondFactors))),prepare:(0,ea.Sx)(async({input:e})=>{let{params:t,parent:r,resendable:n}=e,s=r.getSnapshot().context.clerk,i=s.client.signIn.secondFactorVerification.expireAt,o=n||!i||i<new Date;return(t5(t,"Second factor params"),"phone_code"===t.strategy&&o)?await s.client.signIn.prepareSecondFactor({strategy:t.strategy,phoneNumberId:t.phoneNumberId}):Promise.resolve(s.client.signIn)}),attempt:(0,ea.Sx)(async({input:e})=>{var t;let{fields:r,parent:n,currentFactor:s}=e,i=null==(t=r.get("code"))?void 0:t.value;return t5(s,"Current factor"),t5(i,"Code"),await n.getSnapshot().context.clerk.client.signIn.attemptSecondFactor({strategy:s.strategy,code:i})})}}),rt={complete:"CLERKJS.NAVIGATE.COMPLETE",signUp:"CLERKJS.NAVIGATE.SIGN_UP",continue:"CLERKJS.NAVIGATE.CONTINUE",generic:"CLERKJS.NAVIGATE.GENERIC",resetPassword:"CLERKJS.NAVIGATE.RESET_PASSWORD",signIn:"CLERKJS.NAVIGATE.SIGN_IN",verification:"CLERKJS.NAVIGATE.VERIFICATION"},rr=(0,ea.Sx)(async({input:{flow:e,params:t,parent:r}})=>{let n=r.getSnapshot().context.clerk;return n.client[e].authenticateWithRedirect({redirectUrl:n.buildUrlWithAuth(t.redirectUrl||"/"),redirectUrlComplete:n.buildUrlWithAuth(t.redirectUrlComplete||"/"),...t})}),rn=(0,ea.SP)(({sendBack:e,input:t})=>{var r,n;let s=t.getSnapshot().context.clerk,i=null==(r=s.__unstable__environment)?void 0:r.displayConfig;return(null!=(n=s.clerkjs)?n:s).handleRedirectCallback({continueSignUpUrl:rt.continue,firstFactorUrl:rt.signIn,resetPasswordUrl:rt.resetPassword,secondFactorUrl:rt.signIn,verifyEmailAddressUrl:rt.verification,verifyPhoneNumberUrl:rt.verification,signUpUrl:rt.signUp,signInUrl:rt.signIn},t=>{let r=t.split("/").slice(-1)[0];return!function(e){return Object.values(rt).includes(e)}(r)?r===(null==i?void 0:i.signInUrl)?e({type:rt.signIn}):r===(null==i?void 0:i.signUpUrl)?e({type:rt.signUp}):e({type:"FAILURE",error:new eE(`Unknown navigation event: ${r}`)}):e({type:r}),Promise.resolve()}),()=>void 0}),rs="ThirdParty",ri=(0,Q.mj)({actors:{handleRedirectCallback:rn,redirect:rr},actions:{logError:(0,Z.l)(({event:e})=>`Error: ${e.type}`),assignActiveStrategy:(0,Z.a)({activeStrategy:({event:e})=>((0,Q.DT)(e,"REDIRECT"),e.params.strategy)}),unassignActiveStrategy:(0,Z.a)({activeStrategy:null}),sendToNext:({context:e})=>e.parent.send({type:"NEXT"}),sendToLoading:tz,setFormErrors:(0,Z.c)(({context:e})=>e.formRef,({event:e})=>(t4(e),{type:"ERRORS.SET",error:e.error}))},guards:{isExampleMode:({context:e})=>!!e.parent.getSnapshot().context.exampleMode},types:{}}).createMachine({id:rs,context:({input:e})=>({activeStrategy:null,basePath:e.basePath,formRef:e.formRef,flow:e.flow,parent:e.parent,loadingStep:"strategy"}),initial:"Idle",states:{Idle:{description:"Sets third-party providers if not already set, and waits for a redirect or callback event",on:{CALLBACK:"HandlingCallback",REDIRECT:{guard:(0,eh.E)("isExampleMode"),target:"Redirecting",reenter:!0}}},Redirecting:{description:"Redirects to the third-party provider for authentication",tags:["state:redirect","state:loading"],entry:["assignActiveStrategy","sendToLoading"],exit:["unassignActiveStrategy","sendToLoading"],invoke:{id:"redirect",src:"redirect",input:({context:e,event:t})=>{var r;(0,Q.DT)(t,"REDIRECT");let n=null==(r=e.formRef.getSnapshot().context.fields.get("legalAccepted"))?void 0:r.checked;return{basePath:e.basePath,flow:e.flow,params:{...t.params,legalAccepted:n||void 0},parent:e.parent}},onError:{actions:"setFormErrors",target:"Idle"}}},HandlingCallback:{description:"Handles the callback from the third-party provider",tags:["state:callback","state:loading"],invoke:{id:"handleRedirectCallback",src:"handleRedirectCallback",input:({context:e})=>e.parent,onError:{actions:["logError","setFormErrors"],target:"Idle"}},on:{"CLERKJS.NAVIGATE.*":{actions:"sendToNext",target:"Idle"}}}}});function ro(){return"undefined"!=typeof window&&!!window.next&&window.next.version<tB}var ra=(0,Q.mj)({actors:{attempt:(0,ea.Sx)(({input:{fields:e,parent:t}})=>{var r,n;let s=(null==(r=e.get("password"))?void 0:r.value)||"",i=(null==(n=e.get("signOutOfOtherSessions"))?void 0:n.checked)||!1;return t.getSnapshot().context.clerk.client.signIn.resetPassword({password:s,signOutOfOtherSessions:i})})},actions:{sendToLoading:tz,sendToNext:({context:e,event:t})=>e.parent.send({type:"NEXT",resource:t.output}),setFormErrors:(0,Z.c)(({context:e})=>e.formRef,({event:e})=>(t4(e),{type:"ERRORS.SET",error:e.error}))},types:{}}).createMachine({id:"SignInResetPasswordMachine",context:({input:e})=>({loadingStep:"reset-password",parent:e.parent,formRef:e.formRef}),initial:"Pending",states:{Pending:{tags:["state:pending"],description:"Waiting for user input",on:{SUBMIT:{target:"Attempting",reenter:!0}}},Attempting:{tags:["state:attempting","state:loading"],entry:"sendToLoading",invoke:{id:"attempt",src:"attempt",input:({context:e})=>({parent:e.parent,fields:e.formRef.getSnapshot().context.fields}),onDone:{actions:["sendToNext","sendToLoading"]},onError:{actions:["setFormErrors","sendToLoading"],target:"Pending"}}}}}),rl=["emailAddress","phoneNumber"],rc=(0,Q.mj)({actors:{attemptPasskey:(0,ea.Sx)(({input:{parent:e,flow:t}})=>e.getSnapshot().context.clerk.client.signIn.authenticateWithPasskey({flow:t})),attemptWeb3:(0,ea.Sx)(({input:{parent:e,strategy:t}})=>{if("web3_metamask_signature"===t)return e.getSnapshot().context.clerk.client.signIn.authenticateWithMetamask();if("web3_coinbase_wallet_signature"===t)return e.getSnapshot().context.clerk.client.signIn.authenticateWithCoinbaseWallet();if("web3_okx_wallet_signature"===t)return e.getSnapshot().context.clerk.client.signIn.authenticateWithOKXWallet();throw new eE(`Unsupported Web3 strategy: ${t}`)}),attempt:(0,ea.Sx)(({input:{fields:e,parent:t,params:r}})=>{var n;let s=t.getSnapshot().context.clerk,i=e.get("password"),o=e.get("identifier"),a=(null==i?void 0:i.value)?{password:i.value,strategy:"password"}:{};return s.client.signIn.create({...a,...(null==r?void 0:r.ticket)?r:{identifier:null!=(n=null==o?void 0:o.value)?n:""}})})},actions:{sendToNext:({context:e,event:t})=>e.parent.send({type:"NEXT",resource:null==t?void 0:t.output}),sendToLoading:tz,setFormDisabledTicketFields:(0,Z.b)(({context:e,enqueue:t})=>{if(!e.ticket)return;let r=e.formRef.getSnapshot().context.fields;for(let n of rl)r.has(n)&&t.sendTo(e.formRef,{type:"FIELD.DISABLE",field:{name:n}})}),setFormErrors:(0,Z.c)(({context:e})=>e.formRef,({event:e})=>(t4(e),{type:"ERRORS.SET",error:e.error}))},guards:{hasTicket:({context:e})=>!!e.ticket,isExampleMode:({context:e})=>!!e.parent.getSnapshot().context.exampleMode},types:{}}).createMachine({id:"SignInStart",context:({input:e})=>({basePath:e.basePath||t$,parent:e.parent,formRef:e.formRef,loadingStep:"start",ticket:e.ticket}),initial:"Init",states:{Init:{description:"Handle ticket, if present; Else, default to Pending state.",always:[{guard:"hasTicket",target:"Attempting"},{target:"Pending"}]},Pending:{tags:["state:pending"],description:"Waiting for user input",on:{SUBMIT:{guard:(0,eh.E)("isExampleMode"),target:"Attempting",reenter:!0},"AUTHENTICATE.PASSKEY":{guard:(0,eh.E)("isExampleMode"),target:"AttemptingPasskey",reenter:!0},"AUTHENTICATE.PASSKEY.AUTOFILL":{guard:(0,eh.E)("isExampleMode"),target:"AttemptingPasskeyAutoFill",reenter:!1},"AUTHENTICATE.WEB3":{guard:(0,eh.E)("isExampleMode"),target:"AttemptingWeb3",reenter:!0}}},Attempting:{tags:["state:attempting","state:loading"],entry:"sendToLoading",invoke:{id:"attempt",src:"attempt",input:({context:e})=>{let t={fields:e.formRef.getSnapshot().context.fields,parent:e.parent},r=e.ticket?{strategy:"ticket",ticket:e.ticket}:{};return{...t,params:r}},onDone:{actions:["setFormDisabledTicketFields","sendToNext","sendToLoading"]},onError:{actions:["setFormDisabledTicketFields","setFormErrors","sendToLoading"],target:"Pending"}}},AttemptingPasskey:{tags:["state:attempting","state:loading"],entry:"sendToLoading",invoke:{id:"attemptPasskey",src:"attemptPasskey",input:({context:e})=>({parent:e.parent,flow:"discoverable"}),onDone:{actions:["sendToNext","sendToLoading"]},onError:{actions:["setFormErrors","sendToLoading"],target:"Pending"}}},AttemptingPasskeyAutoFill:{on:{"AUTHENTICATE.PASSKEY":{guard:(0,eh.E)("isExampleMode"),target:"AttemptingPasskey",reenter:!0},SUBMIT:{guard:(0,eh.E)("isExampleMode"),target:"Attempting",reenter:!0}},invoke:{id:"attemptPasskeyAutofill",src:"attemptPasskey",input:({context:e})=>({parent:e.parent,flow:"autofill"}),onDone:{actions:["sendToNext"]},onError:{actions:["setFormErrors"],target:"Pending"}}},AttemptingWeb3:{tags:["state:attempting","state:loading"],entry:"sendToLoading",invoke:{id:"attemptWeb3",src:"attemptWeb3",input:({context:e,event:t})=>((0,Q.DT)(t,"AUTHENTICATE.WEB3"),{parent:e.parent,strategy:t.strategy}),onDone:{actions:["sendToNext","sendToLoading"]},onError:{actions:["setFormErrors","sendToLoading"],target:"Pending"}}}}}),ru=e=>({context:t},r)=>{var n,s;return null!=(s=null==(n=t.router)?void 0:n.match(e))&&s},rd=e=>({context:t,event:r},n)=>{var s,i;return(null==(s=null==r?void 0:r.resource)?void 0:s.status)===e||(null==(i=t.clerk)?void 0:i.client.signIn.status)===e},rh=(0,Q.mj)({actors:{firstFactorMachine:t8,formMachine:eT,resetPasswordMachine:ra,startMachine:rc,secondFactorMachine:re,thirdPartyMachine:ri,webAuthnAutofillSupport:(0,ea.Sx)(()=>eu())},actions:{clearFormErrors:(0,Z.c)(({context:e})=>e.formRef,{type:"ERRORS.CLEAR"}),navigateInternal:({context:e},{path:t,force:r=!1})=>{if(!e.router||!r&&ro()||e.exampleMode)return;let n=(0,ed.oq)(e.router.basePath,t);n!==e.router.pathname()&&e.router.shallowPush(n)},navigateExternal:({context:e},{path:t})=>{var r;return null==(r=e.router)?void 0:r.push(t)},raiseNext:(0,eh.O)({type:"NEXT"}),setActive:(0,Z.b)(({enqueue:e,check:t,context:r,event:n})=>{var s;if(t("isExampleMode"))return;let i=null==n?void 0:n.id,o=r.clerk.client.lastActiveSessionId,a=((null==n?void 0:n.resource)||r.clerk.client.signIn).createdSessionId;r.clerk.setActive({session:i||a||o||null,redirectUrl:r.clerk.buildAfterSignInUrl({params:null==(s=r.router)?void 0:s.searchParams()})}),e.raise({type:"RESET"},{delay:2e3})}),setError:(0,Z.a)({error:(e,{error:t})=>t||new eE("Unknown error")}),setFormErrors:({context:e},t)=>(0,Z.c)(e.formRef,{type:"ERRORS.SET",error:t.error}),setFormOAuthErrors:({context:e})=>{let t,r=e.clerk.client.signIn.firstFactorVerification.error;if(r){switch(r.code){case tq.NOT_ALLOWED_TO_SIGN_UP:case tq.OAUTH_ACCESS_DENIED:case tq.NOT_ALLOWED_ACCESS:case tq.SAML_USER_ATTRIBUTE_MISSING:case tq.OAUTH_EMAIL_DOMAIN_RESERVED_BY_SAML:case tq.USER_LOCKED:case tq.ENTERPRISE_SSO_USER_ATTRIBUTE_MISSING:case tq.ENTERPRISE_SSO_EMAIL_ADDRESS_DOMAIN_MISMATCH:case tq.ENTERPRISE_SSO_HOSTED_DOMAIN_MISMATCH:case tq.SAML_EMAIL_ADDRESS_DOMAIN_MISMATCH:case tq.ORGANIZATION_MEMBERSHIP_QUOTA_EXCEEDED_FOR_SSO:t=new eS(r.code,r.longMessage||"");break;default:t=new eS("unable_to_complete","Unable to complete action at this time. If the problem persists please contact support.")}e.formRef.send({type:"ERRORS.SET",error:t})}},transfer:({context:e})=>{var t;let r=new URLSearchParams({__clerk_transfer:"1"});null==(t=e.router)||t.push(`${e.signUpPath}?${r}`)}},guards:{hasAuthenticatedViaClerkJS:({context:e})=>!!(null===e.clerk.client.signIn.status&&e.clerk.client.lastActiveSessionId),hasOAuthError:({context:e})=>{var t,r,n,s;return!!(null==(s=null==(n=null==(r=null==(t=e.clerk)?void 0:t.client)?void 0:r.signIn)?void 0:n.firstFactorVerification)?void 0:s.error)},hasResource:({context:e})=>{var t,r,n;return!!(null==(n=null==(r=null==(t=e.clerk)?void 0:t.client)?void 0:r.signIn)?void 0:n.status)},hasTicket:({context:e})=>!!e.ticket,isLoggedInAndSingleSession:(0,eh.D)(["isLoggedIn","isSingleSessionMode",(0,eh.E)("isExampleMode")]),isActivePathRoot:ru("/"),isComplete:({context:e,event:t})=>{let r=null==t?void 0:t.resource,n=e.clerk.client.signIn;return(null==r?void 0:r.status)==="complete"&&!!(null==r?void 0:r.createdSessionId)||"complete"===n.status&&!!n.createdSessionId},isLoggedIn:({context:e})=>{var t;return!!(null==(t=e.clerk)?void 0:t.user)},isSingleSessionMode:({context:e})=>{var t,r;return!!(null==(r=null==(t=e.clerk)?void 0:t.__unstable__environment)?void 0:r.authConfig.singleSessionMode)},isExampleMode:({context:e})=>!!e.exampleMode,needsStart:(0,eh.F)([(0,eh.E)("hasResource"),"statusNeedsIdentifier",ru("/")]),needsFirstFactor:(0,eh.D)(["statusNeedsFirstFactor",ru("/continue")]),needsSecondFactor:(0,eh.D)(["statusNeedsSecondFactor",ru("/continue")]),needsCallback:ru(tj),needsChooseSession:ru("/choose"),needsNewPassword:(0,eh.D)(["statusNeedsNewPassword",ru("/new-password")]),statusNeedsIdentifier:rd("needs_identifier"),statusNeedsFirstFactor:rd("needs_first_factor"),statusNeedsSecondFactor:rd("needs_second_factor"),statusNeedsNewPassword:rd("needs_new_password")},types:{}}).createMachine({id:"SignInRouter",context:{},initial:"Idle",on:{"AUTHENTICATE.OAUTH":{actions:(0,Z.c)(rs,({context:e,event:t})=>{var r,n,s,i;return{type:"REDIRECT",params:{strategy:t.strategy,redirectUrl:`${(null==(r=e.router)?void 0:r.mode)===tY.virtual?null==(n=e.clerk.__unstable__environment)?void 0:n.displayConfig.signInUrl:null==(s=e.router)?void 0:s.basePath}${tj}`,redirectUrlComplete:e.clerk.buildAfterSignInUrl({params:null==(i=e.router)?void 0:i.searchParams()})}}})},"AUTHENTICATE.SAML":{actions:(0,Z.c)(rs,({context:e})=>{var t,r,n,s,i;return{type:"REDIRECT",params:{strategy:"saml",identifier:null==(t=e.formRef.getSnapshot().context.fields.get("identifier"))?void 0:t.value,redirectUrl:`${(null==(r=e.router)?void 0:r.mode)===tY.virtual?null==(n=e.clerk.__unstable__environment)?void 0:n.displayConfig.signInUrl:null==(s=e.router)?void 0:s.basePath}${tj}`,redirectUrlComplete:e.clerk.buildAfterSignInUrl({params:null==(i=e.router)?void 0:i.searchParams()})}}})},"AUTHENTICATE.ENTERPRISE_SSO":{actions:(0,Z.c)(rs,({context:e})=>{var t,r,n,s,i;return{type:"REDIRECT",params:{strategy:"enterprise_sso",identifier:null==(t=e.formRef.getSnapshot().context.fields.get("identifier"))?void 0:t.value,redirectUrl:`${(null==(r=e.router)?void 0:r.mode)===tY.virtual?null==(n=e.clerk.__unstable__environment)?void 0:n.displayConfig.signInUrl:null==(s=e.router)?void 0:s.basePath}${tj}`,redirectUrlComplete:e.clerk.buildAfterSignInUrl({params:null==(i=e.router)?void 0:i.searchParams()})}}})},"FORM.ATTACH":{description:"Attach/re-attach the form to the router.",actions:(0,Z.b)(({enqueue:e,event:t})=>{e.assign({formRef:t.formRef}),e.raise({type:"RESET.STEP"})})},"NAVIGATE.PREVIOUS":".Hist","NAVIGATE.START":".Start",LOADING:{actions:(0,Z.a)(({event:e})=>({loading:{isLoading:e.isLoading,step:e.step,strategy:e.strategy,action:e.action}}))},RESET:".Idle"},states:{Idle:{invoke:{id:"webAuthnAutofill",src:"webAuthnAutofillSupport",onDone:{actions:(0,Z.a)({webAuthnAutofillSupport:({event:e})=>e.output})}},on:{INIT:{actions:(0,Z.a)(({event:e})=>{var t;let r=null==(t=e.router)?void 0:t.searchParams();return{clerk:e.clerk,exampleMode:e.exampleMode||!1,formRef:e.formRef,loading:{isLoading:!1},router:e.router,signUpPath:e.signUpPath||tG,ticket:(null==r?void 0:r.get(tK.ticket))||void 0}}),target:"Init"}}},Init:{entry:(0,Z.b)(({context:e,enqueue:t,self:r})=>{var n,s;r.getSnapshot().children[rs]||t.spawnChild("thirdPartyMachine",{id:rs,systemId:rs,input:{basePath:null!=(s=null==(n=e.router)?void 0:n.basePath)?s:t$,flow:"signIn",formRef:e.formRef,parent:r}})}),always:[{guard:"needsCallback",target:"Callback"},{guard:"needsChooseSession",target:"ChooseSession"},{guard:"isComplete",actions:"setActive"},{guard:"isLoggedInAndSingleSession",actions:[(0,Z.l)("Already logged in"),{type:"navigateExternal",params:({context:e})=>{var t;return{path:e.clerk.buildAfterSignInUrl({params:null==(t=e.router)?void 0:t.searchParams()})}}}]},{guard:"needsStart",actions:{type:"navigateInternal",params:{force:!0,path:"/"}},target:"Start"},{guard:"needsFirstFactor",actions:{type:"navigateInternal",params:{force:!0,path:"/continue"}},target:"FirstFactor"},{guard:"needsSecondFactor",actions:{type:"navigateInternal",params:{force:!0,path:"/continue"}},target:"SecondFactor"},{guard:"needsNewPassword",actions:{type:"navigateInternal",params:{force:!0,path:"/reset-password"}},target:"ResetPassword"},{actions:{type:"navigateInternal",params:{force:!0,path:"/"}},target:"Start"},{guard:"hasTicket",actions:{type:"navigateInternal",params:{force:!0,path:"/"}},target:"Start"}]},Start:{tags:["step:start"],exit:"clearFormErrors",invoke:{id:"start",src:"startMachine",input:({context:e,self:t})=>{var r;return{basePath:null==(r=e.router)?void 0:r.basePath,formRef:e.formRef,parent:t,ticket:e.ticket}},onDone:{actions:"raiseNext"}},on:{"RESET.STEP":{target:"Start",reenter:!0},"AUTHENTICATE.PASSKEY":{actions:(0,Z.c)("start",({event:e})=>e)},"AUTHENTICATE.PASSKEY.AUTOFILL":{actions:(0,Z.c)("start",({event:e})=>e)},"AUTHENTICATE.WEB3":{actions:(0,Z.c)("start",({event:e})=>e)},NEXT:[{guard:"isComplete",actions:"setActive"},{guard:"statusNeedsFirstFactor",actions:{type:"navigateInternal",params:{path:"/continue"}},target:"FirstFactor"},{guard:"statusNeedsSecondFactor",actions:{type:"navigateInternal",params:{path:"/continue"}},target:"SecondFactor"},{guard:"statusNeedsNewPassword",actions:{type:"navigateInternal",params:{path:"/reset-password"}},target:"ResetPassword"}]}},FirstFactor:{tags:["step:first-factor","step:verifications"],invoke:{id:"firstFactor",src:"firstFactorMachine",input:({context:e,self:t})=>{var r;return{formRef:e.formRef,parent:t,basePath:null==(r=e.router)?void 0:r.basePath}},onDone:{actions:"raiseNext"}},on:{"AUTHENTICATE.PASSKEY":{actions:(0,Z.c)("firstFactor",({event:e})=>e)},"RESET.STEP":{target:"FirstFactor",reenter:!0},NEXT:[{guard:"isComplete",actions:"setActive"},{guard:"statusNeedsSecondFactor",actions:{type:"navigateInternal",params:{path:"/continue"}},target:"SecondFactor"},{guard:"statusNeedsNewPassword",actions:{type:"navigateInternal",params:{path:"/reset-password"}},target:"ResetPassword"}],"STRATEGY.UPDATE":{description:"Send event to verification machine to update the current strategy.",actions:(0,Z.c)("firstFactor",({event:e})=>e),target:".Idle"}},initial:"Idle",states:{Idle:{on:{"NAVIGATE.FORGOT_PASSWORD":{description:"Navigate to forgot password screen.",actions:(0,Z.c)("firstFactor",({event:e})=>e),target:"ForgotPassword"},"NAVIGATE.CHOOSE_STRATEGY":{description:"Navigate to choose strategy screen.",actions:(0,Z.c)("firstFactor",({event:e})=>e),target:"ChoosingStrategy"}}},ChoosingStrategy:{tags:["step:choose-strategy"],on:{"NAVIGATE.PREVIOUS":{description:"Go to Idle, and also tell firstFactor to go to Pending",target:"Idle",actions:(0,Z.c)("firstFactor",{type:"NAVIGATE.PREVIOUS"})}}},ForgotPassword:{tags:["step:forgot-password"],on:{"NAVIGATE.PREVIOUS":"Idle"}}}},SecondFactor:{tags:["step:second-factor","step:verifications"],invoke:{id:"secondFactor",src:"secondFactorMachine",input:({context:e,self:t})=>({formRef:e.formRef,parent:t}),onDone:{actions:"raiseNext"}},on:{"RESET.STEP":{target:"SecondFactor",reenter:!0},NEXT:[{guard:"isComplete",actions:"setActive"},{guard:"statusNeedsNewPassword",actions:{type:"navigateInternal",params:{path:"/reset-password"}},target:"ResetPassword"}],"STRATEGY.UPDATE":{description:"Send event to verification machine to update the current strategy.",actions:(0,Z.c)("secondFactor",({event:e})=>e),target:".Idle"}},initial:"Idle",states:{Idle:{on:{"NAVIGATE.CHOOSE_STRATEGY":{description:"Navigate to choose strategy screen.",actions:(0,Z.c)("secondFactor",({event:e})=>e),target:"ChoosingStrategy"}}},ChoosingStrategy:{tags:["step:choose-strategy"],on:{"NAVIGATE.PREVIOUS":{description:"Go to Idle, and also tell firstFactor to go to Pending",target:"Idle",actions:(0,Z.c)("secondFactor",{type:"NAVIGATE.PREVIOUS"})}}}}},ResetPassword:{tags:["step:reset-password"],invoke:{id:"resetPassword",src:"resetPasswordMachine",input:({context:e,self:t})=>({formRef:e.formRef,parent:t}),onDone:{actions:"raiseNext"}},on:{"RESET.STEP":{target:"ResetPassword",reenter:!0},NEXT:[{guard:"isComplete",actions:"setActive"},{guard:"statusNeedsFirstFactor",actions:{type:"navigateInternal",params:{path:"/continue"}},target:"FirstFactor"},{guard:"statusNeedsSecondFactor",actions:{type:"navigateInternal",params:{path:"/continue"}},target:"SecondFactor"}]}},Callback:{tags:["step:callback"],entry:(0,Z.c)(rs,{type:"CALLBACK"}),on:{NEXT:[{guard:"hasOAuthError",actions:["setFormOAuthErrors",{type:"navigateInternal",params:{force:!0,path:"/"}}],target:"Start"},{guard:(0,eh.F)(["isLoggedIn","isComplete","hasAuthenticatedViaClerkJS"]),actions:"setActive"},{guard:"statusNeedsIdentifier",actions:"transfer"},{guard:"statusNeedsFirstFactor",actions:{type:"navigateInternal",params:{path:"/continue"}},target:"FirstFactor"},{guard:"statusNeedsSecondFactor",actions:{type:"navigateInternal",params:{path:"/continue"}},target:"SecondFactor"},{guard:"statusNeedsNewPassword",actions:{type:"navigateInternal",params:{path:"/reset-password"}},target:"ResetPassword"}]}},ChooseSession:{tags:["step:choose-session"],on:{"SESSION.SET_ACTIVE":{actions:{type:"setActive",params:({event:e})=>({id:e.id})}}}},Error:{tags:["step:error"],on:{NEXT:{target:"Start",actions:"clearFormErrors"}}},Hist:{type:"history",exit:"clearFormErrors"}}});function rp(e){return t=>{var r,n,s;let i=null==(r=t.context.clerk)?void 0:r.client.signIn;if(e){let t=[...null!=(n=i.supportedFirstFactors)?n:[],...null!=(s=i.supportedSecondFactors)?s:[]].filter(t=>t.strategy===e),r=i.identifier&&t.length>0?t.find(e=>"safeIdentifier"in e&&e.safeIdentifier===i.identifier):null,o=t[0];if(r&&"safeIdentifier"in r)return r.safeIdentifier;if(o&&"safeIdentifier"in o)return o.safeIdentifier}return i.identifier||""}}var rf={firstFactor:"firstFactor",secondFactor:"secondFactor"},rm=tM("SignInChooseStrategyCtx");function rg({asChild:e,children:t,...r}){let n=e7.useActorRef(),s=tp(n,["step:verifications","step:first-factor","step:choose-strategy"],th.all),i=tp(n,["step:verifications","step:second-factor","step:choose-strategy"],th.all),o=e?p.DX:"div";return s||i?(0,l.jsx)(rm.Provider,{children:(0,l.jsx)(o,{...r,children:t})}):null}function rv({asChild:e,children:t,...r}){let n=tp(e7.useActorRef(),["step:verifications","step:first-factor","step:forgot-password"],th.all),s=e?p.DX:"div";return n?(0,l.jsx)(rm.Provider,{children:(0,l.jsx)(s,{...r,children:t})}):null}var ry=s.forwardRef(({asChild:e,children:t,name:r,...n},i)=>{let o=e7.useActorRef(),a=o.getSnapshot(),c=a.context.clerk.client.signIn.status,u=[..."needs_first_factor"===c&&a.context.clerk.client.signIn.supportedFirstFactors||[],..."needs_second_factor"===c&&a.context.clerk.client.signIn.supportedSecondFactors||[]].find(e=>r===e.strategy),d=(0,Y.d4)(a.children[rf.firstFactor]||a.children[rf.secondFactor],e=>{var t;return null==(t=null==e?void 0:e.context.currentFactor)?void 0:t.strategy}),h=s.useCallback(()=>o.send({type:"STRATEGY.UPDATE",factor:u}),[o,u]);if(d===r)return null;let f=e?p.DX:"button";return u?(0,l.jsx)(ti.Provider,{value:{strategy:r},children:(0,l.jsx)(f,{...e?{}:{type:"button"},...n,ref:i,onClick:h,children:t||u.strategy})}):null});ry.displayName="SignInSupportedStrategy";var r_=e6("SignInResetPasswordCtx");function rS(e){return tp(e7.useActorRef(),"step:reset-password")?(0,l.jsx)(rE,{...e}):null}function rE(e){let t=tn();return t?(0,l.jsx)(r_.Provider,{actorRef:t,children:(0,l.jsx)(e4,{flowActor:t,...e})}):null}function rx({children:e}){return tp(e7.useActorRef(),"step:callback")?e:null}var rT=e6("SignInStartCtx");function rw(e){return tp(e7.useActorRef(),"step:start")?(0,l.jsx)(rb,{...e}):null}function rb(e){let t=te();return t?(0,l.jsx)(rT.Provider,{actorRef:t,children:(0,l.jsx)(e4,{flowActor:t,...e})}):null}var rR=(e,t)=>!!e&&!!t&&(e===t||e.startsWith(`${t}_`)),rA=e6("SignInFirstFactorCtx"),rI=e6("SignInSecondFactorCtx"),rk=e=>{var t;return null==(t=e.context.currentFactor)?void 0:t.strategy};function rC({children:e,preferred:t,actorRef:r,...n}){let i=e7.useActorRef(),o=(0,Y.d4)(r,rk),a=tp(i,["step:choose-strategy","step:forgot-password"]),c=(0,s.useCallback)(e=>!!o&&rR(o,e),[o]);return(0,l.jsx)(ta.Provider,{value:{current:o,preferred:t,isActive:c},children:a.active?null:(0,l.jsx)(e4,{flowActor:r,...n,children:e})})}function rP({children:e,name:t}){let{active:r}=function(e){let t=(0,s.useContext)(ta);if(!t)throw new eE('useStrategy must be used within a <SignIn.Step name="verifications"> component. Did you mean to `import { Step } from "@clerk/elements/sign-up"` instead?');let{current:r,preferred:n,isActive:i}=t;return{current:r,preferred:n,get active(){return i(e)}}}(t),n=function(){let e=rA.useActorRef(!0),t=rI.useActorRef(!0);return e||t}();return(0,s.useEffect)(()=>(n&&n.send({type:"STRATEGY.REGISTER",factor:t}),()=>{(null==n?void 0:n.getSnapshot().status)==="active"&&n.send({type:"STRATEGY.UNREGISTER",factor:t})}),[n,t]),r?(0,l.jsx)(ti.Provider,{value:{strategy:t},children:e}):null}function rN(e){let{activeTags:t}=tp(e7.useActorRef(),["step:first-factor","step:second-factor"]);return t.has("step:first-factor")?(0,l.jsx)(rL,{...e}):t.has("step:second-factor")?(0,l.jsx)(rM,{...e}):null}function rL(e){let t=tt();return t&&t?(0,l.jsx)(rA.Provider,{actorRef:t,children:(0,l.jsx)(rC,{actorRef:t,...e})}):null}function rM(e){let t=tr();return t&&t?(0,l.jsx)(rI.Provider,{actorRef:t,children:(0,l.jsx)(rC,{actorRef:t,...e})}):null}var rF={start:"start",verifications:"verifications","choose-strategy":"choose-strategy","choose-session":"choose-session","forgot-password":"forgot-password","reset-password":"reset-password","sso-callback":"sso-callback"};function rO(e){var t;switch(null==(t=(0,ee.ho)().telemetry)||t.record((0,en.we)("Elements_SignInStep",{name:e.name})),e.name){case rF.start:return(0,l.jsx)(rw,{...e});case rF.verifications:return(0,l.jsx)(rN,{...e});case rF["choose-strategy"]:return(0,l.jsx)(rg,{...e});case rF["forgot-password"]:return(0,l.jsx)(rv,{...e});case rF["reset-password"]:return(0,l.jsx)(rS,{...e});case rF["choose-session"]:return(0,l.jsx)(tD,{...e});case rF["sso-callback"]:return(0,l.jsx)(rx,{...e});default:throw new eE(`Invalid step name. Use: ${Object.keys(rF).join(",")}.`)}}var rU=e6("SignUpContinueCtx");function rD(e){return tp(tx.useActorRef(),"step:continue")?(0,l.jsx)(rj,{...e}):null}function rj(e){let t=tb();return t?(0,l.jsx)(rU.Provider,{actorRef:t,children:(0,l.jsx)(e4,{flowActor:t,...e})}):null}function rH(e){let t=tx.useActorRef();return tp(t,"step:restricted")?(0,l.jsx)(e4,{flowActor:t,...e}):null}var rV=e6("SignUpStartCtx");function r$(e){return tp(tx.useActorRef(),"step:start")?(0,l.jsx)(rG,{...e}):null}function rG(e){let t=tw();return t?(0,l.jsx)(rV.Provider,{actorRef:t,children:(0,l.jsx)(e4,{flowActor:t,...e})}):null}var rB=e6("SignUpVerificationCtx");function rK(e){return tp(tx.useActorRef(),"step:verification")?(0,l.jsx)(rX,{...e}):null}function rX(e){let t=tR();return t?(0,l.jsx)(rB.Provider,{actorRef:t,children:(0,l.jsx)(e4,{flowActor:t,...e})}):null}function rW({children:e,name:t}){let r=rB.useActorRef(!0);if(!r)throw Error('<Strategy> used outside of <SignUp>. Did you mean to `import { Strategy } from "@clerk/elements/sign-in"` instead?');let{active:n}=tp(r,[`verification:${t}`,`verification:category:${t}`]);return n?(0,l.jsx)(l.Fragment,{children:e}):null}var rq={start:"start",continue:"continue",verifications:"verifications",restricted:"restricted"};function rY(e){var t;switch(null==(t=(0,ee.ho)().telemetry)||t.record((0,en.we)("Elements_SignUpStep",{name:e.name})),e.name){case rq.start:return(0,l.jsx)(r$,{...e});case rq.continue:return(0,l.jsx)(rD,{...e});case rq.verifications:return(0,l.jsx)(rK,{...e});case rq.restricted:return(0,l.jsx)(rH,{...e});default:throw new eE("Invalid step name. Use 'start', 'continue', 'verifications', or 'restricted'.")}}function rz(e){return e.startsWith("provider:")}function rJ(e){if("provider:metamask"===e)return"web3_metamask_signature";if("provider:coinbase_wallet"===e)return"web3_coinbase_wallet_signature";if("provider:okx_wallet"===e)return"web3_okx_wallet_signature";if("provider:saml"===e)return"saml";if("provider:enterprise_sso"===e)return"enterprise_sso";let t=e.replace("provider:","");return`oauth_${t}`}},2070:(e,t,r)=>{"use strict";r.d(t,{jv:()=>u,d4:()=>c});var n=r(2115),s=n.useLayoutEffect,i=r(9733),o=r(5643);r(9033);let a=(e,t)=>{t(e);let r=e.getSnapshot().children;r&&Object.values(r).forEach(e=>{a(e,t)})};function l(e,t){return e===t}function c(e,t,r=l){let s=(0,n.useCallback)(t=>{if(!e)return()=>{};let{unsubscribe:r}=e.subscribe(t);return r},[e]),i=(0,n.useCallback)(()=>e?.getSnapshot(),[e]);return(0,o.useSyncExternalStoreWithSelector)(s,i,i,t,r)}function u(e,t){let r=n.createContext(null),o=r.Provider;function l({children:r,logic:l=e,machine:c,options:u}){if(c)throw Error('The "machine" prop has been deprecated. Please use "logic" instead.');let d=function(e,...[t,r]){let o=function(e,...[t]){let[[r,o],a]=(0,n.useState)(()=>{let r=(0,i.A)(e,t);return[e.config,r]});if(e.config!==r){let r=(0,i.A)(e,{...t,snapshot:o.getPersistedSnapshot({__unsafeAllowInlineActors:!0})});a([e.config,r]),o=r}return s(()=>{o.logic.implementations=e.implementations}),o}(e,t);return(0,n.useEffect)(()=>{if(!r)return;let e=o.subscribe((0,i.L)(r));return()=>{e.unsubscribe()}},[r]),(0,n.useEffect)(()=>(o.start(),()=>{var e=o;let t=[];a(e,e=>{t.push([e,e.getSnapshot()]),e.observers=new Set});let r=e.system.getSnapshot?.();e.stop(),e.system._snapshot=r,t.forEach(([e,t])=>{e._processingStatus=0,e._snapshot=t})}),[o]),o}(l,{...t,...u});return n.createElement(o,{value:d,children:r})}function u(){let e=n.useContext(r);if(!e)throw Error(`You used a hook from "${l.displayName}" but it's not inside a <${l.displayName}> component.`);return e}return l.displayName="ActorProvider",{Provider:l,useActorRef:u,useSelector:function(e,t){return c(u(),e,t)}}}},2459:(e,t,r)=>{"use strict";r.d(t,{v:()=>s});var n=new Set,s={warnOnce:e=>{n.has(e)||(n.add(e),console.warn(e))},logOnce:e=>{n.has(e)||(console.log(e),n.add(e))}};r(5649)},3200:(e,t,r)=>{"use strict";r.d(t,{Ix:()=>u,_s:()=>a,cb:()=>c});var n=r(1173);r(5649);var s=r(2115),i=["after_sign_in_url","after_sign_up_url","redirect_url"];function o(e){return(0,n.ae)((0,n.GP)(e))}var a=(0,s.createContext)(null),l=(0,s.createContext)(null);function c(){let e=(0,s.useContext)(l);if(!e)throw Error("clerk: Unable to locate ClerkRouter, make sure this is rendered within `<Router>`.");return e}function u({basePath:e,children:t,router:r}){let c=function(){let e=(0,s.useContext)(a);if(!e)throw Error("clerk: Unable to locate ClerkHostRouter, make sure this is rendered within `<ClerkHostRouterContext.Provider>`.");return e}(),u=function e(t,r="/"){let s=o(r);function a(e){if((0,n.vh)(e))return e;let r=new URL(e,window.location.origin),s=t.searchParams();return i.forEach(e=>{let t=s.get(e);t&&r.searchParams.set(e,t)}),`${r.pathname}${r.search}`}return{makeDestinationUrlWithPreservedQueryParameters:a,child:function(r){return e(t,`${s}${o(r)}`)},match:function(e,r){let n=e??(r&&"/");if(!n)throw Error("[clerk] router.match() requires either a path to match, or the index flag must be set to true.");let i=o(n);return o(`${s}${i}`)===o(t.pathname())},mode:t.mode,name:t.name,push:function(e){let r=a(e);return t.push(r)},replace:function(e){let r=a(e);return t.replace(r)},shallowPush:function(e){let r=a(e);return t.shallowPush(r)},pathname:function(){return t.pathname()},searchParams:function(){return t.searchParams()},basePath:s}}(r??c,e);return s.createElement(l.Provider,{value:u},t)}},4579:(e,t,r)=>{"use strict";r.d(t,{sF:()=>n.sF,zz:()=>n.zz});var n=r(852);r(5649)},5583:(e,t,r)=>{e.exports=r(1569)},5732:(e,t,r)=>{"use strict";r.d(t,{oq:()=>n.oq});var n=r(1173);r(5649)},6101:(e,t,r)=>{"use strict";r.d(t,{s:()=>o,t:()=>i});var n=r(2115);function s(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function i(...e){return t=>{let r=!1,n=e.map(e=>{let n=s(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():s(e[t],null)}}}}function o(...e){return n.useCallback(i(...e),e)}},6241:(e,t,r)=>{"use strict";r.d(t,{Ok:()=>p,cY:()=>d});var n,s,i=r(1640),o=r(2115),a=r(5695),l=r(5583);r(3200);var c=class{constructor(e){this.name="VirtualRouter",this.mode="virtual",(0,i.VK)(this,n),(0,i.VK)(this,s,new Set);let t="undefined"==typeof window?"https://clerk.dummy":window.location.origin;(0,i.OV)(this,n,new URL(null!=e?e:"/",t))}push(e){let t=new URL((0,i.S7)(this,n).toString());t.pathname=e,(0,i.OV)(this,n,t),this.emit()}replace(e){this.push(e)}shallowPush(e){this.push(e)}pathname(){return(0,i.S7)(this,n).pathname}searchParams(){return(0,i.S7)(this,n).searchParams}subscribe(e){return(0,i.S7)(this,s).add(e),()=>(0,i.S7)(this,s).delete(e)}emit(){(0,i.S7)(this,s).forEach(e=>e((0,i.S7)(this,n)))}getSnapshot(){return(0,i.S7)(this,n)}};n=new WeakMap,s=new WeakMap;var u=new c("/"),d=()=>{let e=(0,o.useSyncExternalStore)(u.subscribe.bind(u),u.getSnapshot.bind(u));return{mode:u.mode,name:u.name,pathname:()=>e.pathname,push:u.push.bind(u),replace:u.replace.bind(u),searchParams:()=>e.searchParams,shallowPush:u.shallowPush.bind(u)}},h=()=>{let e=o.useRef(),t=(0,l.useRouter)();if(t)if(e.current)return e.current;else return e.current=t.pathname.replace(/\/\[\[\.\.\..*/,""),e.current;let r=((0,a.usePathname)()||"").split("/").filter(Boolean),n=Object.values((0,a.useParams)()||{}).filter(e=>Array.isArray(e)).flat(1/0);return e.current||(e.current=`/${r.slice(0,r.length-n.length).join("/")}`),e.current},p=()=>{let e=(0,a.useRouter)(),t=(0,a.usePathname)(),r=(0,a.useSearchParams)(),n=h(),s="undefined"!=typeof window&&window.next&&window.next.version>=i.rX;return{mode:"path",name:"NextRouter",push:t=>e.push(t),replace:t=>s?window.history.replaceState(null,"",t):e.replace(t),shallowPush:t=>s?window.history.pushState(null,"",t):e.push(t,{}),pathname:()=>t,searchParams:()=>r,inferredBasePath:()=>n}}},9311:(e,t,r)=>{"use strict";r.d(t,{B:()=>i});var n=r(3264);function s(e,t){if(t===n.RJ4)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t!==n.rYR&&t!==n.O49)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e;{let r=e.getIndex();if(null===r){let t=[],n=e.getAttribute("position");if(void 0===n)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<n.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}let s=r.count-2,i=[];if(t===n.rYR)for(let e=1;e<=s;e++)i.push(r.getX(0)),i.push(r.getX(e)),i.push(r.getX(e+1));else for(let e=0;e<s;e++)e%2==0?(i.push(r.getX(e)),i.push(r.getX(e+1)),i.push(r.getX(e+2))):(i.push(r.getX(e+2)),i.push(r.getX(e+1)),i.push(r.getX(e)));i.length/3!==s&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let o=e.clone();return o.setIndex(i),o.clearGroups(),o}}class i extends n.aHM{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new d(e)}),this.register(function(e){return new h(e)}),this.register(function(e){return new E(e)}),this.register(function(e){return new x(e)}),this.register(function(e){return new T(e)}),this.register(function(e){return new f(e)}),this.register(function(e){return new m(e)}),this.register(function(e){return new g(e)}),this.register(function(e){return new v(e)}),this.register(function(e){return new u(e)}),this.register(function(e){return new y(e)}),this.register(function(e){return new p(e)}),this.register(function(e){return new S(e)}),this.register(function(e){return new _(e)}),this.register(function(e){return new l(e)}),this.register(function(e){return new w(e)}),this.register(function(e){return new b(e)})}load(e,t,r,s){let i,o=this;if(""!==this.resourcePath)i=this.resourcePath;else if(""!==this.path){let t=n.r6x.extractUrlBase(e);i=n.r6x.resolveURL(t,this.path)}else i=n.r6x.extractUrlBase(e);this.manager.itemStart(e);let a=function(t){s?s(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},l=new n.Y9S(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(r){try{o.parse(r,i,function(r){t(r),o.manager.itemEnd(e)},a)}catch(e){a(e)}},r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,n){let s,i={},o={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===R){try{i[a.KHR_BINARY_GLTF]=new I(e)}catch(e){n&&n(e);return}s=JSON.parse(i[a.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2){n&&n(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let u=new Y(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){let t=this.pluginCallbacks[e](u);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[t.name]=t,i[t.name]=!0}if(s.extensionsUsed)for(let e=0;e<s.extensionsUsed.length;++e){let t=s.extensionsUsed[e],r=s.extensionsRequired||[];switch(t){case a.KHR_MATERIALS_UNLIT:i[t]=new c;break;case a.KHR_DRACO_MESH_COMPRESSION:i[t]=new k(s,this.dracoLoader);break;case a.KHR_TEXTURE_TRANSFORM:i[t]=new C;break;case a.KHR_MESH_QUANTIZATION:i[t]=new P;break;default:r.indexOf(t)>=0&&void 0===o[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}u.setExtensions(i),u.setPlugins(o),u.parse(r,n)}parseAsync(e,t){let r=this;return new Promise(function(n,s){r.parse(e,t,n,s)})}}function o(){let e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}let a={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class l{constructor(e){this.parser=e,this.name=a.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let r=0,n=t.length;r<n;r++){let n=t[r];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&e._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(e){let t,r=this.parser,s="light:"+e,i=r.cache.get(s);if(i)return i;let o=r.json,a=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e],l=new n.Q1f(0xffffff);void 0!==a.color&&l.setRGB(a.color[0],a.color[1],a.color[2],n.Zr2);let c=void 0!==a.range?a.range:0;switch(a.type){case"directional":(t=new n.ZyN(l)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new n.HiM(l)).distance=c;break;case"spot":(t=new n.nCl(l)).distance=c,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,t.angle=a.spot.outerConeAngle,t.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return t.position.set(0,0,0),K(t,a),void 0!==a.intensity&&(t.intensity=a.intensity),t.name=r.createUniqueName(a.name||"light_"+e),i=Promise.resolve(t),r.cache.add(s,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){let t=this,r=this.parser,n=r.json.nodes[e],s=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===s?null:this._loadLight(s).then(function(e){return r._getNodeRef(t.cache,s,e)})}}class c{constructor(){this.name=a.KHR_MATERIALS_UNLIT}getMaterialType(){return n.V9B}extendParams(e,t,r){let s=[];e.color=new n.Q1f(1,1,1),e.opacity=1;let i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){let t=i.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],n.Zr2),e.opacity=t[3]}void 0!==i.baseColorTexture&&s.push(r.assignTexture(e,"map",i.baseColorTexture,n.er$))}return Promise.all(s)}}class u{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name].emissiveStrength;return void 0!==n&&(t.emissiveIntensity=n),Promise.resolve()}}class d{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let i=[],o=s.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&i.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&i.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(i.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){let e=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new n.I9Y(e,e)}return Promise.all(i)}}class h{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_DISPERSION}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name];return t.dispersion=void 0!==n.dispersion?n.dispersion:0,Promise.resolve()}}class p{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],i=n.extensions[this.name];return void 0!==i.iridescenceFactor&&(t.iridescence=i.iridescenceFactor),void 0!==i.iridescenceTexture&&s.push(r.assignTexture(t,"iridescenceMap",i.iridescenceTexture)),void 0!==i.iridescenceIor&&(t.iridescenceIOR=i.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==i.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),void 0!==i.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),void 0!==i.iridescenceThicknessTexture&&s.push(r.assignTexture(t,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(s)}}class f{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_SHEEN}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let i=[];t.sheenColor=new n.Q1f(0,0,0),t.sheenRoughness=0,t.sheen=1;let o=s.extensions[this.name];if(void 0!==o.sheenColorFactor){let e=o.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],n.Zr2)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&i.push(r.assignTexture(t,"sheenColorMap",o.sheenColorTexture,n.er$)),void 0!==o.sheenRoughnessTexture&&i.push(r.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(i)}}class m{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],i=n.extensions[this.name];return void 0!==i.transmissionFactor&&(t.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&s.push(r.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(s)}}class g{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_VOLUME}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let i=[],o=s.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&i.push(r.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;let a=o.attenuationColor||[1,1,1];return t.attenuationColor=new n.Q1f().setRGB(a[0],a[1],a[2],n.Zr2),Promise.all(i)}}class v{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_IOR}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name];return t.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}}class y{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_SPECULAR}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let i=[],o=s.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&i.push(r.assignTexture(t,"specularIntensityMap",o.specularTexture));let a=o.specularColorFactor||[1,1,1];return t.specularColor=new n.Q1f().setRGB(a[0],a[1],a[2],n.Zr2),void 0!==o.specularColorTexture&&i.push(r.assignTexture(t,"specularColorMap",o.specularColorTexture,n.er$)),Promise.all(i)}}class _{constructor(e){this.parser=e,this.name=a.EXT_MATERIALS_BUMP}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],i=n.extensions[this.name];return t.bumpScale=void 0!==i.bumpFactor?i.bumpFactor:1,void 0!==i.bumpTexture&&s.push(r.assignTexture(t,"bumpMap",i.bumpTexture)),Promise.all(s)}}class S{constructor(e){this.parser=e,this.name=a.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?n.uSd:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],i=n.extensions[this.name];return void 0!==i.anisotropyStrength&&(t.anisotropy=i.anisotropyStrength),void 0!==i.anisotropyRotation&&(t.anisotropyRotation=i.anisotropyRotation),void 0!==i.anisotropyTexture&&s.push(r.assignTexture(t,"anisotropyMap",i.anisotropyTexture)),Promise.all(s)}}class E{constructor(e){this.parser=e,this.name=a.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;let s=n.extensions[this.name],i=t.options.ktx2Loader;if(!i)if(!(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0))return null;else throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return t.loadTextureImage(e,s.source,i)}}class x{constructor(e){this.parser=e,this.name=a.EXT_TEXTURE_WEBP}loadTexture(e){let t=this.name,r=this.parser,n=r.json,s=n.textures[e];if(!s.extensions||!s.extensions[t])return null;let i=s.extensions[t],o=n.images[i.source],a=r.textureLoader;if(o.uri){let e=r.options.manager.getHandler(o.uri);null!==e&&(a=e)}return r.loadTextureImage(e,i.source,a)}}class T{constructor(e){this.parser=e,this.name=a.EXT_TEXTURE_AVIF}loadTexture(e){let t=this.name,r=this.parser,n=r.json,s=n.textures[e];if(!s.extensions||!s.extensions[t])return null;let i=s.extensions[t],o=n.images[i.source],a=r.textureLoader;if(o.uri){let e=r.options.manager.getHandler(o.uri);null!==e&&(a=e)}return r.loadTextureImage(e,i.source,a)}}class w{constructor(e){this.name=a.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,r=t.bufferViews[e];if(!r.extensions||!r.extensions[this.name])return null;{let e=r.extensions[this.name],n=this.parser.getDependency("buffer",e.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported)if(!(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0))return null;else throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return n.then(function(t){let r=e.byteOffset||0,n=e.byteLength||0,i=e.count,o=e.byteStride,a=new Uint8Array(t,r,n);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(i,o,a,e.mode,e.filter).then(function(e){return e.buffer}):s.ready.then(function(){let t=new ArrayBuffer(i*o);return s.decodeGltfBuffer(new Uint8Array(t),i,o,a,e.mode,e.filter),t})})}}}class b{constructor(e){this.name=a.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;for(let e of t.meshes[r.mesh].primitives)if(e.mode!==F.TRIANGLES&&e.mode!==F.TRIANGLE_STRIP&&e.mode!==F.TRIANGLE_FAN&&void 0!==e.mode)return null;let s=r.extensions[this.name].attributes,i=[],o={};for(let e in s)i.push(this.parser.getDependency("accessor",s[e]).then(t=>(o[e]=t,o[e])));return i.length<1?null:(i.push(this.parser.createNodeMesh(e)),Promise.all(i).then(e=>{let t=e.pop(),r=t.isGroup?t.children:[t],s=e[0].count,i=[];for(let e of r){let t=new n.kn4,r=new n.Pq0,a=new n.PTz,l=new n.Pq0(1,1,1),c=new n.ZLX(e.geometry,e.material,s);for(let e=0;e<s;e++)o.TRANSLATION&&r.fromBufferAttribute(o.TRANSLATION,e),o.ROTATION&&a.fromBufferAttribute(o.ROTATION,e),o.SCALE&&l.fromBufferAttribute(o.SCALE,e),c.setMatrixAt(e,t.compose(r,a,l));for(let t in o)if("_COLOR_0"===t){let e=o[t];c.instanceColor=new n.uWO(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,o[t]);n.B69.prototype.copy.call(c,e),this.parser.assignFinalMaterial(c),i.push(c)}return t.isGroup?(t.clear(),t.add(...i),t):i[0]}))}}let R="glTF",A={JSON:0x4e4f534a,BIN:5130562};class I{constructor(e){this.name=a.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,12),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==R)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let n=this.header.length-12,s=new DataView(e,12),i=0;for(;i<n;){let t=s.getUint32(i,!0);i+=4;let n=s.getUint32(i,!0);if(i+=4,n===A.JSON){let n=new Uint8Array(e,12+i,t);this.content=r.decode(n)}else if(n===A.BIN){let r=12+i;this.body=e.slice(r,r+t)}i+=t}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}}class k{constructor(e,t){if(!t)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=a.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let r=this.json,s=this.dracoLoader,i=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(let e in o)a[H[e]||e.toLowerCase()]=o[e];for(let t in e.attributes){let n=H[t]||t.toLowerCase();if(void 0!==o[t]){let s=r.accessors[e.attributes[t]],i=O[s.componentType];c[n]=i.name,l[n]=!0===s.normalized}}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t,r){s.decodeDracoFile(e,function(e){for(let t in e.attributes){let r=e.attributes[t],n=l[t];void 0!==n&&(r.normalized=n)}t(e)},a,c,n.Zr2,r)})})}}class C{constructor(){this.name=a.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class P{constructor(){this.name=a.KHR_MESH_QUANTIZATION}}class N extends n.lGw{constructor(e,t,r,n){super(e,t,r,n)}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,s=e*n*3+n;for(let e=0;e!==n;e++)t[e]=r[s+e];return t}interpolate_(e,t,r,n){let s=this.resultBuffer,i=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=n-t,u=(r-t)/c,d=u*u,h=d*u,p=e*l,f=p-l,m=-2*h+3*d,g=h-d,v=1-m,y=g-d+u;for(let e=0;e!==o;e++){let t=i[f+e+o],r=i[f+e+a]*c,n=i[p+e+o],l=i[p+e]*c;s[e]=v*t+y*r+m*n+g*l}return s}}let L=new n.PTz;class M extends N{interpolate_(e,t,r,n){let s=super.interpolate_(e,t,r,n);return L.fromArray(s).normalize().toArray(s),s}}let F={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},O={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},U={9728:n.hxR,9729:n.k6q,9984:n.pHI,9985:n.kRr,9986:n.Cfg,9987:n.$_I},D={33071:n.ghU,33648:n.kTW,10497:n.GJx},j={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},H={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},V={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},$={CUBICSPLINE:void 0,LINEAR:n.PJ3,STEP:n.ljd},G={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function B(e,t,r){for(let n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function K(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function X(e){let t="",r=Object.keys(e).sort();for(let n=0,s=r.length;n<s;n++)t+=r[n]+":"+e[r[n]]+";";return t}function W(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}let q=new n.kn4;class Y{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new o,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,s=-1,i=!1,a=-1;if("undefined"!=typeof navigator){let e=navigator.userAgent;r=!0===/^((?!chrome|android).)*safari/i.test(e);let t=e.match(/Version\/(\d+)/);s=r&&t?parseInt(t[1],10):-1,a=(i=e.indexOf("Firefox")>-1)?e.match(/Firefox\/([0-9]+)\./)[1]:-1}"undefined"==typeof createImageBitmap||r&&s<17||i&&a<98?this.textureLoader=new n.Tap(this.options.manager):this.textureLoader=new n.Kzg(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new n.Y9S(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let r=this,n=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(t){let i={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};return B(s,i,n),K(i,n),Promise.all(r._invokeAll(function(e){return e.afterRoot&&e.afterRoot(i)})).then(function(){for(let e of i.scenes)e.updateMatrixWorld();e(i)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let r=0,n=t.length;r<n;r++){let n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let t=0,n=e.length;t<n;t++){let n=e[t];void 0!==n.mesh&&(this._addNodeRef(this.meshCache,n.mesh),void 0!==n.skin&&(r[n.mesh].isSkinnedMesh=!0)),void 0!==n.camera&&this._addNodeRef(this.cameraCache,n.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;let n=r.clone(),s=(e,t)=>{let r=this.associations.get(e);for(let[n,i]of(null!=r&&this.associations.set(t,r),e.children.entries()))s(i,t.children[n])};return s(r,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){let n=e(t[r]);if(n)return n}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let r=[];for(let n=0;n<t.length;n++){let s=e(t[n]);s&&r.push(s)}return r}getDependency(e,t){let r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":n=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:if(!(n=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)})))throw Error("Unknown type: "+e)}this.cache.add(r,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){let r=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(t,n){return r.getDependency(e,n)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[a.KHR_BINARY_GLTF].body);let s=this.options;return new Promise(function(e,i){r.load(n.r6x.resolveURL(t.uri,s.path),e,void 0,function(){i(Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){let r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)})}loadAccessor(e){let t=this,r=this.json,s=this.json.accessors[e];if(void 0===s.bufferView&&void 0===s.sparse){let e=j[s.type],t=O[s.componentType],r=!0===s.normalized,i=new t(s.count*e);return Promise.resolve(new n.THS(i,e,r))}let i=[];return void 0!==s.bufferView?i.push(this.getDependency("bufferView",s.bufferView)):i.push(null),void 0!==s.sparse&&(i.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(i).then(function(e){let i,o,a=e[0],l=j[s.type],c=O[s.componentType],u=c.BYTES_PER_ELEMENT,d=u*l,h=s.byteOffset||0,p=void 0!==s.bufferView?r.bufferViews[s.bufferView].byteStride:void 0,f=!0===s.normalized;if(p&&p!==d){let e=Math.floor(h/p),r="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+e+":"+s.count,d=t.cache.get(r);d||(i=new c(a,e*p,s.count*p/u),d=new n.eB$(i,p/u),t.cache.add(r,d)),o=new n.eHs(d,l,h%p/u,f)}else i=null===a?new c(s.count*l):new c(a,h,s.count*l),o=new n.THS(i,l,f);if(void 0!==s.sparse){let t=j.SCALAR,r=O[s.sparse.indices.componentType],i=s.sparse.indices.byteOffset||0,u=s.sparse.values.byteOffset||0,d=new r(e[1],i,s.sparse.count*t),h=new c(e[2],u,s.sparse.count*l);null!==a&&(o=new n.THS(o.array.slice(),o.itemSize,o.normalized)),o.normalized=!1;for(let e=0,t=d.length;e<t;e++){let t=d[e];if(o.setX(t,h[e*l]),l>=2&&o.setY(t,h[e*l+1]),l>=3&&o.setZ(t,h[e*l+2]),l>=4&&o.setW(t,h[e*l+3]),l>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}o.normalized=f}return o})}loadTexture(e){let t=this.json,r=this.options,n=t.textures[e].source,s=t.images[n],i=this.textureLoader;if(s.uri){let e=r.manager.getHandler(s.uri);null!==e&&(i=e)}return this.loadTextureImage(e,n,i)}loadTextureImage(e,t,r){let s=this,i=this.json,o=i.textures[e],a=i.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];let c=this.loadImageSource(t,r).then(function(t){t.flipY=!1,t.name=o.name||a.name||"",""===t.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(t.name=a.uri);let r=(i.samplers||{})[o.sampler]||{};return t.magFilter=U[r.magFilter]||n.k6q,t.minFilter=U[r.minFilter]||n.$_I,t.wrapS=D[r.wrapS]||n.GJx,t.wrapT=D[r.wrapT]||n.GJx,t.generateMipmaps=!t.isCompressedTexture&&t.minFilter!==n.hxR&&t.minFilter!==n.k6q,s.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){let r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());let i=r.images[e],o=self.URL||self.webkitURL,a=i.uri||"",l=!1;if(void 0!==i.bufferView)a=this.getDependency("bufferView",i.bufferView).then(function(e){l=!0;let t=new Blob([e],{type:i.mimeType});return a=o.createObjectURL(t)});else if(void 0===i.uri)throw Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let c=Promise.resolve(a).then(function(e){return new Promise(function(r,i){let o=r;!0===t.isImageBitmapLoader&&(o=function(e){let t=new n.gPd(e);t.needsUpdate=!0,r(t)}),t.load(n.r6x.resolveURL(e,s.path),o,void 0,i)})}).then(function(e){var t;return!0===l&&o.revokeObjectURL(a),K(e,i),e.userData.mimeType=i.mimeType||((t=i.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":t.search(/\.ktx2($|\?)/i)>0||0===t.search(/^data\:image\/ktx2/)?"image/ktx2":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),e});return this.sourceCache[e]=c,c}assignTexture(e,t,r,n){let s=this;return this.getDependency("texture",r.index).then(function(i){if(!i)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((i=i.clone()).channel=r.texCoord),s.extensions[a.KHR_TEXTURE_TRANSFORM]){let e=void 0!==r.extensions?r.extensions[a.KHR_TEXTURE_TRANSFORM]:void 0;if(e){let t=s.associations.get(i);i=s.extensions[a.KHR_TEXTURE_TRANSFORM].extendTexture(i,e),s.associations.set(i,t)}}return void 0!==n&&(i.colorSpace=n),e[t]=i,i})}assignFinalMaterial(e){let t=e.geometry,r=e.material,s=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){let e="PointsMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new n.BH$,n.imn.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,t.sizeAttenuation=!1,this.cache.add(e,t)),r=t}else if(e.isLine){let e="LineBasicMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new n.mrM,n.imn.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,this.cache.add(e,t)),r=t}if(s||i||o){let e="ClonedMaterial:"+r.uuid+":";s&&(e+="derivative-tangents:"),i&&(e+="vertex-colors:"),o&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=r.clone(),i&&(t.vertexColors=!0),o&&(t.flatShading=!0),s&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}e.material=r}getMaterialType(){return n._4j}loadMaterial(e){let t,r=this,s=this.json,i=this.extensions,o=s.materials[e],l={},c=o.extensions||{},u=[];if(c[a.KHR_MATERIALS_UNLIT]){let e=i[a.KHR_MATERIALS_UNLIT];t=e.getMaterialType(),u.push(e.extendParams(l,o,r))}else{let s=o.pbrMetallicRoughness||{};if(l.color=new n.Q1f(1,1,1),l.opacity=1,Array.isArray(s.baseColorFactor)){let e=s.baseColorFactor;l.color.setRGB(e[0],e[1],e[2],n.Zr2),l.opacity=e[3]}void 0!==s.baseColorTexture&&u.push(r.assignTexture(l,"map",s.baseColorTexture,n.er$)),l.metalness=void 0!==s.metallicFactor?s.metallicFactor:1,l.roughness=void 0!==s.roughnessFactor?s.roughnessFactor:1,void 0!==s.metallicRoughnessTexture&&(u.push(r.assignTexture(l,"metalnessMap",s.metallicRoughnessTexture)),u.push(r.assignTexture(l,"roughnessMap",s.metallicRoughnessTexture))),t=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,l)})))}!0===o.doubleSided&&(l.side=n.$EB);let d=o.alphaMode||G.OPAQUE;if(d===G.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,d===G.MASK&&(l.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&t!==n.V9B&&(u.push(r.assignTexture(l,"normalMap",o.normalTexture)),l.normalScale=new n.I9Y(1,1),void 0!==o.normalTexture.scale)){let e=o.normalTexture.scale;l.normalScale.set(e,e)}if(void 0!==o.occlusionTexture&&t!==n.V9B&&(u.push(r.assignTexture(l,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(l.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==n.V9B){let e=o.emissiveFactor;l.emissive=new n.Q1f().setRGB(e[0],e[1],e[2],n.Zr2)}return void 0!==o.emissiveTexture&&t!==n.V9B&&u.push(r.assignTexture(l,"emissiveMap",o.emissiveTexture,n.er$)),Promise.all(u).then(function(){let n=new t(l);return o.name&&(n.name=o.name),K(n,o),r.associations.set(n,{materials:e}),o.extensions&&B(i,n,o),n})}createUniqueName(e){let t=n.Nwf.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,r=this.extensions,s=this.primitiveCache,i=[];for(let o=0,l=e.length;o<l;o++){let l=e[o],c=function(e){let t,r=e.extensions&&e.extensions[a.KHR_DRACO_MESH_COMPRESSION];if(t=r?"draco:"+r.bufferView+":"+r.indices+":"+X(r.attributes):e.indices+":"+X(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,n=e.targets.length;r<n;r++)t+=":"+X(e.targets[r]);return t}(l),u=s[c];if(u)i.push(u.promise);else{let e;e=l.extensions&&l.extensions[a.KHR_DRACO_MESH_COMPRESSION]?function(e){return r[a.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return z(r,e,t)})}(l):z(new n.LoY,l,t),s[c]={primitive:l,promise:e},i.push(e)}}return Promise.all(i)}loadMesh(e){let t=this,r=this.json,i=this.extensions,o=r.meshes[e],a=o.primitives,l=[];for(let e=0,t=a.length;e<t;e++){var c;let t=void 0===a[e].material?(void 0===(c=this.cache).DefaultMaterial&&(c.DefaultMaterial=new n._4j({color:0xffffff,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:n.hB5})),c.DefaultMaterial):this.getDependency("material",a[e].material);l.push(t)}return l.push(t.loadGeometries(a)),Promise.all(l).then(function(r){let l=r.slice(0,r.length-1),c=r[r.length-1],u=[];for(let r=0,d=c.length;r<d;r++){let d,h=c[r],p=a[r],f=l[r];if(p.mode===F.TRIANGLES||p.mode===F.TRIANGLE_STRIP||p.mode===F.TRIANGLE_FAN||void 0===p.mode)!0===(d=!0===o.isSkinnedMesh?new n.I46(h,f):new n.eaF(h,f)).isSkinnedMesh&&d.normalizeSkinWeights(),p.mode===F.TRIANGLE_STRIP?d.geometry=s(d.geometry,n.O49):p.mode===F.TRIANGLE_FAN&&(d.geometry=s(d.geometry,n.rYR));else if(p.mode===F.LINES)d=new n.DXC(h,f);else if(p.mode===F.LINE_STRIP)d=new n.N1A(h,f);else if(p.mode===F.LINE_LOOP)d=new n.FCc(h,f);else if(p.mode===F.POINTS)d=new n.ONl(h,f);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+p.mode);Object.keys(d.geometry.morphAttributes).length>0&&function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){let r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let t=0,n=r.length;t<n;t++)e.morphTargetDictionary[r[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(d,o),d.name=t.createUniqueName(o.name||"mesh_"+e),K(d,o),p.extensions&&B(i,d,p),t.assignFinalMaterial(d),u.push(d)}for(let r=0,n=u.length;r<n;r++)t.associations.set(u[r],{meshes:e,primitives:r});if(1===u.length)return o.extensions&&B(i,u[0],o),u[0];let d=new n.YJl;o.extensions&&B(i,d,o),t.associations.set(d,{meshes:e});for(let e=0,t=u.length;e<t;e++)d.add(u[e]);return d})}loadCamera(e){let t,r=this.json.cameras[e],s=r[r.type];return s?("perspective"===r.type?t=new n.ubm(n.cj9.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):"orthographic"===r.type&&(t=new n.qUd(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),K(t,r),Promise.resolve(t)):void console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){let t=this.json.skins[e],r=[];for(let e=0,n=t.joints.length;e<n;e++)r.push(this._loadNodeShallow(t.joints[e]));return void 0!==t.inverseBindMatrices?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(e){let r=e.pop(),s=[],i=[];for(let o=0,a=e.length;o<a;o++){let a=e[o];if(a){s.push(a);let e=new n.kn4;null!==r&&e.fromArray(r.array,16*o),i.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}return new n.EAD(s,i)})}loadAnimation(e){let t=this.json,r=this,s=t.animations[e],i=s.name?s.name:"animation_"+e,o=[],a=[],l=[],c=[],u=[];for(let e=0,t=s.channels.length;e<t;e++){let t=s.channels[e],r=s.samplers[t.sampler],n=t.target,i=n.node,d=void 0!==s.parameters?s.parameters[r.input]:r.input,h=void 0!==s.parameters?s.parameters[r.output]:r.output;void 0!==n.node&&(o.push(this.getDependency("node",i)),a.push(this.getDependency("accessor",d)),l.push(this.getDependency("accessor",h)),c.push(r),u.push(n))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(e){let t=e[0],s=e[1],o=e[2],a=e[3],l=e[4],c=[];for(let e=0,n=t.length;e<n;e++){let n=t[e],i=s[e],u=o[e],d=a[e],h=l[e];if(void 0===n)continue;n.updateMatrix&&n.updateMatrix();let p=r._createAnimationTracks(n,i,u,d,h);if(p)for(let e=0;e<p.length;e++)c.push(p[e])}return new n.tz3(i,void 0,c)})}createNodeMesh(e){let t=this.json,r=this,n=t.nodes[e];return void 0===n.mesh?null:r.getDependency("mesh",n.mesh).then(function(e){let t=r._getNodeRef(r.meshCache,n.mesh,e);return void 0!==n.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,r=n.weights.length;t<r;t++)e.morphTargetInfluences[t]=n.weights[t]}),t})}loadNode(e){let t=this.json.nodes[e],r=this._loadNodeShallow(e),n=[],s=t.children||[];for(let e=0,t=s.length;e<t;e++)n.push(this.getDependency("node",s[e]));let i=void 0===t.skin?Promise.resolve(null):this.getDependency("skin",t.skin);return Promise.all([r,Promise.all(n),i]).then(function(e){let t=e[0],r=e[1],n=e[2];null!==n&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(n,q)});for(let e=0,n=r.length;e<n;e++)t.add(r[e]);return t})}_loadNodeShallow(e){let t=this.json,r=this.extensions,s=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];let i=t.nodes[e],o=i.name?s.createUniqueName(i.name):"",a=[],l=s._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return l&&a.push(l),void 0!==i.camera&&a.push(s.getDependency("camera",i.camera).then(function(e){return s._getNodeRef(s.cameraCache,i.camera,e)})),s._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){a.push(e)}),this.nodeCache[e]=Promise.all(a).then(function(t){let a;if((a=!0===i.isBone?new n.$Kf:t.length>1?new n.YJl:1===t.length?t[0]:new n.B69)!==t[0])for(let e=0,r=t.length;e<r;e++)a.add(t[e]);if(i.name&&(a.userData.name=i.name,a.name=o),K(a,i),i.extensions&&B(r,a,i),void 0!==i.matrix){let e=new n.kn4;e.fromArray(i.matrix),a.applyMatrix4(e)}else void 0!==i.translation&&a.position.fromArray(i.translation),void 0!==i.rotation&&a.quaternion.fromArray(i.rotation),void 0!==i.scale&&a.scale.fromArray(i.scale);if(s.associations.has(a)){if(void 0!==i.mesh&&s.meshCache.refs[i.mesh]>1){let e=s.associations.get(a);s.associations.set(a,{...e})}}else s.associations.set(a,{});return s.associations.get(a).nodes=e,a}),this.nodeCache[e]}loadScene(e){let t=this.extensions,r=this.json.scenes[e],s=this,i=new n.YJl;r.name&&(i.name=s.createUniqueName(r.name)),K(i,r),r.extensions&&B(t,i,r);let o=r.nodes||[],a=[];for(let e=0,t=o.length;e<t;e++)a.push(s.getDependency("node",o[e]));return Promise.all(a).then(function(e){for(let t=0,r=e.length;t<r;t++)i.add(e[t]);return s.associations=(e=>{let t=new Map;for(let[e,r]of s.associations)(e instanceof n.imn||e instanceof n.gPd)&&t.set(e,r);return e.traverse(e=>{let r=s.associations.get(e);null!=r&&t.set(e,r)}),t})(i),i})}_createAnimationTracks(e,t,r,s,i){let o,a=[],l=e.name?e.name:e.uuid,c=[];switch(V[i.path]===V.weights?e.traverse(function(e){e.morphTargetInfluences&&c.push(e.name?e.name:e.uuid)}):c.push(l),V[i.path]){case V.weights:o=n.Hit;break;case V.rotation:o=n.MBL;break;case V.translation:case V.scale:o=n.RiT;break;default:o=1===r.itemSize?n.Hit:n.RiT}let u=void 0!==s.interpolation?$[s.interpolation]:n.PJ3,d=this._getArrayFromAccessor(r);for(let e=0,r=c.length;e<r;e++){let r=new o(c[e]+"."+V[i.path],t.array,d,u);"CUBICSPLINE"===s.interpolation&&this._createCubicSplineTrackInterpolant(r),a.push(r)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let e=W(t.constructor),r=new Float32Array(t.length);for(let n=0,s=t.length;n<s;n++)r[n]=t[n]*e;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof n.MBL?M:N)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function z(e,t,r){let s=t.attributes,i=[];for(let t in s){let n=H[t]||t.toLowerCase();n in e.attributes||i.push(function(t,n){return r.getDependency("accessor",t).then(function(t){e.setAttribute(n,t)})}(s[t],n))}if(void 0!==t.indices&&!e.index){let n=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});i.push(n)}return n.ppV.workingColorSpace!==n.Zr2&&"COLOR_0"in s&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${n.ppV.workingColorSpace}" not supported.`),K(e,t),!function(e,t,r){let s=t.attributes,i=new n.NRn;if(void 0===s.POSITION)return;{let e=r.json.accessors[s.POSITION],t=e.min,o=e.max;if(void 0===t||void 0===o)return console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(i.set(new n.Pq0(t[0],t[1],t[2]),new n.Pq0(o[0],o[1],o[2])),e.normalized){let t=W(O[e.componentType]);i.min.multiplyScalar(t),i.max.multiplyScalar(t)}}let o=t.targets;if(void 0!==o){let e=new n.Pq0,t=new n.Pq0;for(let n=0,s=o.length;n<s;n++){let s=o[n];if(void 0!==s.POSITION){let n=r.json.accessors[s.POSITION],i=n.min,o=n.max;if(void 0!==i&&void 0!==o){if(t.setX(Math.max(Math.abs(i[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(i[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(i[2]),Math.abs(o[2]))),n.normalized){let e=W(O[n.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(e)}e.boundingBox=i;let a=new n.iyt;i.getCenter(a.center),a.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=a}(e,t,r),Promise.all(i).then(function(){return void 0!==t.targets?function(e,t,r){let n=!1,s=!1,i=!1;for(let e=0,r=t.length;e<r;e++){let r=t[e];if(void 0!==r.POSITION&&(n=!0),void 0!==r.NORMAL&&(s=!0),void 0!==r.COLOR_0&&(i=!0),n&&s&&i)break}if(!n&&!s&&!i)return Promise.resolve(e);let o=[],a=[],l=[];for(let c=0,u=t.length;c<u;c++){let u=t[c];if(n){let t=void 0!==u.POSITION?r.getDependency("accessor",u.POSITION):e.attributes.position;o.push(t)}if(s){let t=void 0!==u.NORMAL?r.getDependency("accessor",u.NORMAL):e.attributes.normal;a.push(t)}if(i){let t=void 0!==u.COLOR_0?r.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(t){let r=t[0],o=t[1],a=t[2];return n&&(e.morphAttributes.position=r),s&&(e.morphAttributes.normal=o),i&&(e.morphAttributes.color=a),e.morphTargetsRelative=!0,e})}(e,t.targets,r):e})}},9708:(e,t,r)=>{"use strict";r.d(t,{DX:()=>a,TL:()=>o});var n=r(2115),s=r(6101),i=r(5155);function o(e){let t=function(e){let t=n.forwardRef((e,t)=>{let{children:r,...i}=e;if(n.isValidElement(r)){var o;let e,a,l=(o=r,(a=(e=Object.getOwnPropertyDescriptor(o.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?o.ref:(a=(e=Object.getOwnPropertyDescriptor(o,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?o.props.ref:o.props.ref||o.ref),c=function(e,t){let r={...t};for(let n in t){let s=e[n],i=t[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...e)=>{let t=i(...e);return s(...e),t}:s&&(r[n]=s):"style"===n?r[n]={...s,...i}:"className"===n&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...e,...r}}(i,r.props);return r.type!==n.Fragment&&(c.ref=t?(0,s.t)(t,l):l),n.cloneElement(r,c)}return n.Children.count(r)>1?n.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=n.forwardRef((e,r)=>{let{children:s,...o}=e,a=n.Children.toArray(s),l=a.find(c);if(l){let e=l.props.children,s=a.map(t=>t!==l?t:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,i.jsx)(t,{...o,ref:r,children:n.isValidElement(e)?n.cloneElement(e,void 0,s):null})}return(0,i.jsx)(t,{...o,ref:r,children:s})});return r.displayName=`${e}.Slot`,r}var a=o("Slot"),l=Symbol("radix.slottable");function c(e){return n.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===l}},9733:(e,t,r)=>{"use strict";r.d(t,{$:()=>C,A:()=>M,D:()=>W,E:()=>K,F:()=>Y,L:()=>w,M:()=>U,N:()=>o,O:()=>eH,P:()=>H,R:()=>G,S:()=>i,T:()=>P,U:()=>eO,V:()=>l,W:()=>d,X:()=>c,a:()=>x,b:()=>ea,c:()=>b,d:()=>ec,e:()=>z,f:()=>el,g:()=>eo,h:()=>ei,i:()=>ee,j:()=>eg,k:()=>eF,l:()=>en,m:()=>v,n:()=>eR,o:()=>function e(t,r,n,s){if("string"==typeof r){let e=ef(t,r).next(n,s);return e&&e.length?e:t.next(n,s)}if(1===Object.keys(r).length){let i=Object.keys(r),o=e(ef(t,i[0]),r[i[0]],n,s);return o&&o.length?o:t.next(n,s)}let i=[];for(let o of Object.keys(r)){let a=r[o];if(!a)continue;let l=e(ef(t,o),a,n,s);l&&i.push(...l)}return i.length?i:t.next(n,s)},p:()=>eb,q:()=>h,r:()=>ek,s:()=>ex,t:()=>_,u:()=>ep,v:()=>m,w:()=>es,x:()=>em,y:()=>eU,z:()=>R});let n=e=>{if("undefined"==typeof window)return;let t=function(){let e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r.g?r.g:void 0;if(e.__xstate__)return e.__xstate__}();t&&t.register(e)};class s{constructor(e){this._process=e,this._active=!1,this._current=null,this._last=null}start(){this._active=!0,this.flush()}clear(){this._current&&(this._current.next=null,this._last=this._current)}enqueue(e){let t={value:e,next:null};if(this._current){this._last.next=t,this._last=t;return}this._current=t,this._last=t,this._active&&this.flush()}flush(){for(;this._current;){let e=this._current;this._process(e.value),this._current=e.next}this._last=null}}let i=".",o="",a="xstate.init",l="xstate.error",c="xstate.stop";function u(e,t){return{type:`xstate.done.state.${e}`,output:t}}function d(e,t){return{type:`xstate.error.actor.${e}`,error:t,actorId:e}}function h(e){return{type:a,input:e}}function p(e){setTimeout(()=>{throw e})}let f="function"==typeof Symbol&&Symbol.observable||"@@observable";function m(e){if(E(e))return e;let t=[],r="";for(let n=0;n<e.length;n++){switch(e.charCodeAt(n)){case 92:r+=e[n+1],n++;continue;case 46:t.push(r),r="";continue}r+=e[n]}return t.push(r),t}function g(e){var t;return(t=e)&&"object"==typeof t&&"machine"in t&&"value"in t?e.value:"string"!=typeof e?e:function(e){if(1===e.length)return e[0];let t={},r=t;for(let t=0;t<e.length-1;t++)if(t===e.length-2)r[e[t]]=e[t+1];else{let n=r;r={},n[e[t]]=r}return t}(m(e))}function v(e,t){let r={},n=Object.keys(e);for(let s=0;s<n.length;s++){let i=n[s];r[i]=t(e[i],i,e,s)}return r}function y(e){return E(e)?e:[e]}function _(e){var t;return void 0===e?[]:E(t=e)?t:[t]}function S(e,t,r,n){return"function"==typeof e?e({context:t,event:r,self:n}):e}function E(e){return Array.isArray(e)}function x(e){var t;return(E(t=e)?t:[t]).map(e=>void 0===e||"string"==typeof e?{target:e}:e)}function T(e){if(void 0!==e&&""!==e)return _(e)}function w(e,t,r){let n="object"==typeof e,s=n?e:void 0;return{next:(n?e.next:e)?.bind(s),error:(n?e.error:t)?.bind(s),complete:(n?e.complete:r)?.bind(s)}}function b(e,t){return`${t}.${e}`}function R(e,t){let r=t.match(/^xstate\.invoke\.(\d+)\.(.*)/);if(!r)return e.implementations.actors[t];let[,n,s]=r,i=e.getStateNodeById(s).config.invoke;return(Array.isArray(i)?i[n]:i).src}function A(e,t){return`${e.sessionId}.${t}`}let I=0,k=!1,C=1,P=function(e){return e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped",e}({}),N={clock:{setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e)},logger:console.log.bind(console),devTools:!1};class L{constructor(e,t){this.logic=e,this._snapshot=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new s(this._process.bind(this)),this.observers=new Set,this.eventListeners=new Map,this.logger=void 0,this._processingStatus=P.NotStarted,this._parent=void 0,this._syncSnapshot=void 0,this.ref=void 0,this._actorScope=void 0,this._systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];let r={...N,...t},{clock:n,logger:i,parent:o,syncSnapshot:a,id:l,systemId:c,inspect:u}=r;this.system=o?o.system:function(e,t){let r=new Map,n=new Map,s=new WeakMap,i=new Set,o={},{clock:a,logger:l}=t,c={schedule:(e,t,r,n,s=Math.random().toString(36).slice(2))=>{let i={source:e,target:t,event:r,delay:n,id:s,startedAt:Date.now()},l=A(e,s);u._snapshot._scheduledEvents[l]=i;let c=a.setTimeout(()=>{delete o[l],delete u._snapshot._scheduledEvents[l],u._relay(e,t,r)},n);o[l]=c},cancel:(e,t)=>{let r=A(e,t),n=o[r];delete o[r],delete u._snapshot._scheduledEvents[r],void 0!==n&&a.clearTimeout(n)},cancelAll:e=>{for(let t in u._snapshot._scheduledEvents){let r=u._snapshot._scheduledEvents[t];r.source===e&&c.cancel(e,r.id)}}},u={_snapshot:{_scheduledEvents:(t?.snapshot&&t.snapshot.scheduler)??{}},_bookId:()=>`x:${I++}`,_register:(e,t)=>(r.set(e,t),e),_unregister:e=>{r.delete(e.sessionId);let t=s.get(e);void 0!==t&&(n.delete(t),s.delete(e))},get:e=>n.get(e),_set:(e,t)=>{let r=n.get(e);if(r&&r!==t)throw Error(`Actor with system ID '${e}' already exists.`);n.set(e,t),s.set(t,e)},inspect:e=>{let t=w(e);return i.add(t),{unsubscribe(){i.delete(t)}}},_sendInspectionEvent:t=>{if(!i.size)return;let r={...t,rootId:e.sessionId};i.forEach(e=>e.next?.(r))},_relay:(e,t,r)=>{u._sendInspectionEvent({type:"@xstate.event",sourceRef:e,actorRef:t,event:r}),t._send(r)},scheduler:c,getSnapshot:()=>({_scheduledEvents:{...u._snapshot._scheduledEvents}}),start:()=>{let e=u._snapshot._scheduledEvents;for(let t in u._snapshot._scheduledEvents={},e){let{source:r,target:n,event:s,delay:i,id:o}=e[t];c.schedule(r,n,s,i,o)}},_clock:a,_logger:l};return u}(this,{clock:n,logger:i}),u&&!o&&this.system.inspect(w(u)),this.sessionId=this.system._bookId(),this.id=l??this.sessionId,this.logger=t?.logger??this.system._logger,this.clock=t?.clock??this.system._clock,this._parent=o,this._syncSnapshot=a,this.options=r,this.src=r.src??e,this.ref=this,this._actorScope={self:this,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:e=>{this._deferred.push(e)},system:this.system,stopChild:e=>{if(e._parent!==this)throw Error(`Cannot stop child actor ${e.id} of ${this.id} because it is not a child`);e._stop()},emit:e=>{let t=this.eventListeners.get(e.type),r=this.eventListeners.get("*");if(t||r)for(let n of[...t?t.values():[],...r?r.values():[]])n(e)},actionExecutor:e=>{let t=()=>{if(this._actorScope.system._sendInspectionEvent({type:"@xstate.action",actorRef:this,action:{type:e.type,params:e.params}}),!e.exec)return;let t=k;try{k=!0,e.exec(e.info,e.params)}finally{k=t}};this._processingStatus===P.Running?t():this._deferred.push(t)}},this.send=this.send.bind(this),this.system._sendInspectionEvent({type:"@xstate.actor",actorRef:this}),c&&(this._systemId=c,this.system._set(c,this)),this._initState(t?.snapshot??t?.state),c&&"active"!==this._snapshot.status&&this.system._unregister(this)}_initState(e){try{this._snapshot=e?this.logic.restoreSnapshot?this.logic.restoreSnapshot(e,this._actorScope):e:this.logic.getInitialSnapshot(this._actorScope,this.options?.input)}catch(e){this._snapshot={status:"error",output:void 0,error:e}}}update(e,t){let r;for(this._snapshot=e;r=this._deferred.shift();)try{r()}catch(t){this._deferred.length=0,this._snapshot={...e,status:"error",error:t}}switch(this._snapshot.status){case"active":for(let t of this.observers)try{t.next?.(e)}catch(e){p(e)}break;case"done":var n;for(let t of this.observers)try{t.next?.(e)}catch(e){p(e)}this._stopProcedure(),this._complete(),this._doneEvent=(n=this.id,{type:`xstate.done.actor.${n}`,output:this._snapshot.output,actorId:n}),this._parent&&this.system._relay(this,this._parent,this._doneEvent);break;case"error":this._error(this._snapshot.error)}this.system._sendInspectionEvent({type:"@xstate.snapshot",actorRef:this,event:t,snapshot:e})}subscribe(e,t,r){let n=w(e,t,r);if(this._processingStatus!==P.Stopped)this.observers.add(n);else switch(this._snapshot.status){case"done":try{n.complete?.()}catch(e){p(e)}break;case"error":{let e=this._snapshot.error;if(n.error)try{n.error(e)}catch(e){p(e)}else p(e)}}return{unsubscribe:()=>{this.observers.delete(n)}}}on(e,t){let r=this.eventListeners.get(e);r||(r=new Set,this.eventListeners.set(e,r));let n=t.bind(void 0);return r.add(n),{unsubscribe:()=>{r.delete(n)}}}start(){if(this._processingStatus===P.Running)return this;this._syncSnapshot&&this.subscribe({next:e=>{"active"===e.status&&this.system._relay(this,this._parent,{type:`xstate.snapshot.${this.id}`,snapshot:e})},error:()=>{}}),this.system._register(this.sessionId,this),this._systemId&&this.system._set(this._systemId,this),this._processingStatus=P.Running;let e=h(this.options.input);switch(this.system._sendInspectionEvent({type:"@xstate.event",sourceRef:this._parent,actorRef:this,event:e}),this._snapshot.status){case"done":return this.update(this._snapshot,e),this;case"error":return this._error(this._snapshot.error),this}if(this._parent||this.system.start(),this.logic.start)try{this.logic.start(this._snapshot,this._actorScope)}catch(e){return this._snapshot={...this._snapshot,status:"error",error:e},this._error(e),this}return this.update(this._snapshot,e),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this}_process(e){let t,r;try{t=this.logic.transition(this._snapshot,e,this._actorScope)}catch(e){r={err:e}}if(r){let{err:e}=r;this._snapshot={...this._snapshot,status:"error",error:e},this._error(e);return}this.update(t,e),e.type===c&&(this._stopProcedure(),this._complete())}_stop(){return this._processingStatus===P.Stopped||((this.mailbox.clear(),this._processingStatus===P.NotStarted)?this._processingStatus=P.Stopped:this.mailbox.enqueue({type:c})),this}stop(){if(this._parent)throw Error("A non-root actor cannot be stopped directly.");return this._stop()}_complete(){for(let e of this.observers)try{e.complete?.()}catch(e){p(e)}this.observers.clear()}_reportError(e){if(!this.observers.size){this._parent||p(e);return}let t=!1;for(let r of this.observers){let n=r.error;t||=!n;try{n?.(e)}catch(e){p(e)}}this.observers.clear(),t&&p(e)}_error(e){this._stopProcedure(),this._reportError(e),this._parent&&this.system._relay(this,this._parent,d(this.id,e))}_stopProcedure(){return this._processingStatus!==P.Running||(this.system.scheduler.cancelAll(this),this.mailbox.clear(),this.mailbox=new s(this._process.bind(this)),this._processingStatus=P.Stopped,this.system._unregister(this)),this}_send(e){this._processingStatus!==P.Stopped&&this.mailbox.enqueue(e)}send(e){this.system._relay(void 0,this,e)}attachDevTools(){let{devTools:e}=this.options;e&&("function"==typeof e?e:n)(this)}toJSON(){return{xstate$$type:C,id:this.id}}getPersistedSnapshot(e){return this.logic.getPersistedSnapshot(this._snapshot,e)}[f](){return this}getSnapshot(){return this._snapshot}}function M(e,...[t]){return new L(e,t)}function F(e,t,r,n,{sendId:s}){return[t,{sendId:"function"==typeof s?s(r,n):s},void 0]}function O(e,t){e.defer(()=>{e.system.scheduler.cancel(e.self,t.sendId)})}function U(e){function t(e,t){}return t.type="xstate.cancel",t.sendId=e,t.resolve=F,t.execute=O,t}function D(e,t,r,n,{id:s,systemId:i,src:o,input:a,syncSnapshot:l}){let c,u,d="string"==typeof o?R(t.machine,o):o,h="function"==typeof s?s(r):s;return d&&(u="function"==typeof a?a({context:t.context,event:r.event,self:e.self}):a,c=M(d,{id:h,src:o,parent:e.self,syncSnapshot:l,systemId:i,input:u})),[eO(t,{children:{...t.children,[h]:c}}),{id:s,systemId:i,actorRef:c,src:o,input:u},void 0]}function j(e,{actorRef:t}){t&&e.defer(()=>{t._processingStatus!==P.Stopped&&t.start()})}function H(...[e,{id:t,systemId:r,input:n,syncSnapshot:s=!1}={}]){function i(e,t){}return i.type="xstate.spawnChild",i.id=t,i.systemId=r,i.src=e,i.input=n,i.syncSnapshot=s,i.resolve=D,i.execute=j,i}function V(e,t,r,n,{actorRef:s}){let i="function"==typeof s?s(r,n):s,o="string"==typeof i?t.children[i]:i,a=t.children;return o&&(a={...a},delete a[o.id]),[eO(t,{children:a}),o,void 0]}function $(e,t){if(t){if(e.system._unregister(t),t._processingStatus!==P.Running)return void e.stopChild(t);e.defer(()=>{e.stopChild(t)})}}function G(e){function t(e,t){}return t.type="xstate.stopChild",t.actorRef=e,t.resolve=V,t.execute=$,t}function B(e,{context:t,event:r},{guards:n}){return!z(n[0],t,r,e)}function K(e){function t(e,t){return!1}return t.check=B,t.guards=[e],t}function X(e,{context:t,event:r},{guards:n}){return n.every(n=>z(n,t,r,e))}function W(e){function t(e,t){return!1}return t.check=X,t.guards=e,t}function q(e,{context:t,event:r},{guards:n}){return n.some(n=>z(n,t,r,e))}function Y(e){function t(e,t){return!1}return t.check=q,t.guards=e,t}function z(e,t,r,n){let{machine:s}=n,i="function"==typeof e,o=i?e:s.implementations.guards["string"==typeof e?e:e.type];if(!i&&!o)throw Error(`Guard '${"string"==typeof e?e:e.type}' is not implemented.'.`);if("function"!=typeof o)return z(o,t,r,n);let a={context:t,event:r},l=i||"string"==typeof e?void 0:"params"in e?"function"==typeof e.params?e.params({context:t,event:r}):e.params:void 0;return"check"in o?o.check(n,a,o):o(a,l)}let J=e=>"atomic"===e.type||"final"===e.type;function Q(e){return Object.values(e.states).filter(e=>"history"!==e.type)}function Z(e,t){let r=[];if(t===e)return r;let n=e.parent;for(;n&&n!==t;)r.push(n),n=n.parent;return r}function ee(e){let t=new Set(e),r=et(t);for(let e of t)if("compound"!==e.type||r.get(e)&&r.get(e).length){if("parallel"===e.type){for(let r of Q(e))if("history"!==r.type&&!t.has(r))for(let e of eh(r))t.add(e)}}else eh(e).forEach(e=>t.add(e));for(let e of t){let r=e.parent;for(;r;)t.add(r),r=r.parent}return t}function et(e){let t=new Map;for(let r of e)t.has(r)||t.set(r,[]),r.parent&&(t.has(r.parent)||t.set(r.parent,[]),t.get(r.parent).push(r));return t}function er(e,t){return function e(t,r){let n=r.get(t);if(!n)return{};if("compound"===t.type){let e=n[0];if(!e)return{};if(J(e))return e.key}let s={};for(let t of n)s[t.key]=e(t,r);return s}(e,et(ee(t)))}function en(e,t){return"compound"===t.type?Q(t).some(t=>"final"===t.type&&e.has(t)):"parallel"===t.type?Q(t).every(t=>en(e,t)):"final"===t.type}let es=e=>"#"===e[0];function ei(e,t){return e.transitions.get(t)||[...e.transitions.keys()].filter(e=>{if("*"===e)return!0;if(!e.endsWith(".*"))return!1;let r=e.split("."),n=t.split(".");for(let e=0;e<r.length;e++){let t=r[e],s=n[e];if("*"===t)return e===r.length-1;if(t!==s)return!1}return!0}).sort((e,t)=>t.length-e.length).flatMap(t=>e.transitions.get(t))}function eo(e){let t=e.config.after;if(!t)return[];let r=t=>{var r;let n=(r=e.id,{type:`xstate.after.${t}.${r}`}),s=n.type;return e.entry.push(eH(n,{id:s,delay:t})),e.exit.push(U(s)),s};return Object.keys(t).flatMap(e=>{let n=t[e],s=Number.isNaN(+e)?e:+e,i=r(s);return _("string"==typeof n?{target:n}:n).map(e=>({...e,event:i,delay:s}))}).map(t=>{let{delay:r}=t;return{...ea(e,t.event,t),delay:r}})}function ea(e,t,r){let n=T(r.target),s=r.reenter??!1,o=function(e,t){if(void 0!==t)return t.map(t=>{if("string"!=typeof t)return t;if(es(t))return e.machine.getStateNodeById(t);let r=t[0]===i;if(r&&!e.parent)return em(e,t.slice(1));let n=r?e.key+t:t;if(e.parent)try{return em(e.parent,n)}catch(t){throw Error(`Invalid transition definition for state node '${e.id}':
${t.message}`)}throw Error(`Invalid target: "${t}" is not a valid target from the root node. Did you mean ".${t}"?`)})}(e,n),a={...r,actions:_(r.actions),guard:r.guard,target:o,source:e,reenter:s,eventType:t,toJSON:()=>({...a,source:`#${e.id}`,target:o?o.map(e=>`#${e.id}`):void 0})};return a}function el(e){let t=new Map;if(e.config.on)for(let r of Object.keys(e.config.on)){if(r===o)throw Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');let n=e.config.on[r];t.set(r,x(n).map(t=>ea(e,r,t)))}if(e.config.onDone){let r=`xstate.done.state.${e.id}`;t.set(r,x(e.config.onDone).map(t=>ea(e,r,t)))}for(let r of e.invoke){if(r.onDone){let n=`xstate.done.actor.${r.id}`;t.set(n,x(r.onDone).map(t=>ea(e,n,t)))}if(r.onError){let n=`xstate.error.actor.${r.id}`;t.set(n,x(r.onError).map(t=>ea(e,n,t)))}if(r.onSnapshot){let n=`xstate.snapshot.${r.id}`;t.set(n,x(r.onSnapshot).map(t=>ea(e,n,t)))}}for(let r of e.after){let e=t.get(r.eventType);e||(e=[],t.set(r.eventType,e)),e.push(r)}return t}function ec(e,t){let r="string"==typeof t?e.states[t]:t?e.states[t.target]:void 0;if(!r&&t)throw Error(`Initial state node "${t}" not found on parent state node #${e.id}`);let n={source:e,actions:t&&"string"!=typeof t?_(t.actions):[],eventType:null,reenter:!1,target:r?[r]:[],toJSON:()=>({...n,source:`#${e.id}`,target:r?[`#${r.id}`]:[]})};return n}function eu(e){let t=T(e.config.target);return t?{target:t.map(t=>"string"==typeof t?em(e.parent,t):t)}:e.parent.initial}function ed(e){return"history"===e.type}function eh(e){let t=ep(e);for(let r of t)for(let n of Z(r,e))t.add(n);return t}function ep(e){let t=new Set;return!function e(r){if(!t.has(r)){if(t.add(r),"compound"===r.type)e(r.initial.target[0]);else if("parallel"===r.type)for(let t of Q(r))e(t)}}(e),t}function ef(e,t){if(es(t))return e.machine.getStateNodeById(t);if(!e.states)throw Error(`Unable to retrieve child state '${t}' from '${e.id}'; no child states exist.`);let r=e.states[t];if(!r)throw Error(`Child state '${t}' does not exist on '${e.id}'`);return r}function em(e,t){if("string"==typeof t&&es(t))try{return e.machine.getStateNodeById(t)}catch{}let r=m(t).slice(),n=e;for(;r.length;){let e=r.shift();if(!e.length)break;n=ef(n,e)}return n}function eg(e,t){if("string"==typeof t){let r=e.states[t];if(!r)throw Error(`State '${t}' does not exist on '${e.id}'`);return[e,r]}let r=Object.keys(t),n=r.map(t=>ef(e,t)).filter(Boolean);return[e.machine.root,e].concat(n,r.reduce((r,n)=>{let s=ef(e,n);if(!s)return r;let i=eg(s,t[n]);return r.concat(i)},[]))}function ev(e,t){let r=e;for(;r.parent&&r.parent!==t;)r=r.parent;return r.parent===t}function ey(e,t,r){let n=new Set;for(let s of e){let e=!1,i=new Set;for(let o of n)if(function(e,t){let r=new Set(e),n=new Set(t);for(let e of r)if(n.has(e))return!0;for(let e of n)if(r.has(e))return!0;return!1}(eE([s],t,r),eE([o],t,r)))if(ev(s.source,o.source))i.add(o);else{e=!0;break}if(!e){for(let e of i)n.delete(e);n.add(s)}}return Array.from(n)}function e_(e,t){if(!e.target)return[];let r=new Set;for(let n of e.target)if(ed(n))if(t[n.id])for(let e of t[n.id])r.add(e);else for(let e of e_(eu(n),t))r.add(e);else r.add(n);return[...r]}function eS(e,t){let r=e_(e,t);if(!r)return;if(!e.reenter&&r.every(t=>t===e.source||ev(t,e.source)))return e.source;let n=function(e){let[t,...r]=e;for(let e of Z(t,void 0))if(r.every(t=>ev(t,e)))return e}(r.concat(e.source));return n||(e.reenter?void 0:e.source.machine.root)}function eE(e,t,r){let n=new Set;for(let s of e)if(s.target?.length){let e=eS(s,r);for(let r of(s.reenter&&s.source===e&&n.add(e),t))ev(r,e)&&n.add(r)}return[...n]}function ex(e,t,r,n,s,i){if(!e.length)return t;let o=new Set(t._nodes),a=t.historyValue,l=ey(e,o,a),c=t;s||([c,a]=function(e,t,r,n,s,i,o,a){let l,c=e,u=eE(n,s,i);for(let e of(u.sort((e,t)=>t.order-e.order),u))for(let t of function(e){return Object.keys(e.states).map(t=>e.states[t]).filter(e=>"history"===e.type)}(e)){let r;r="deep"===t.history?t=>J(t)&&ev(t,e):t=>t.parent===e,(l??={...i})[t.id]=Array.from(s).filter(r)}for(let e of u)c=eb(c,t,r,[...e.exit,...e.invoke.map(e=>G(e.id))],o,void 0),s.delete(e);return[c,l||i]}(c,n,r,l,o,a,i,r.actionExecutor)),c=function(e,t,r,n,s,i,o,a){let l=e,c=new Set,d=new Set;(function(e,t,r,n){for(let s of e){let e=eS(s,t);for(let i of s.target||[])!ed(i)&&(s.source!==i||s.source!==e||s.reenter)&&(n.add(i),r.add(i)),eT(i,t,r,n);for(let i of e_(s,t)){let o=Z(i,e);e?.type==="parallel"&&o.push(e),ew(n,t,r,o,!s.source.parent&&s.reenter?void 0:e)}}})(n,o,d,c),a&&d.add(e.machine.root);let h=new Set;for(let e of[...c].sort((e,t)=>e.order-t.order)){s.add(e);let n=[];for(let t of(n.push(...e.entry),e.invoke))n.push(H(t.src,{...t,syncSnapshot:!!t.onSnapshot}));if(d.has(e)){let t=e.initial.actions;n.push(...t)}if(l=eb(l,t,r,n,i,e.invoke.map(e=>e.id)),"final"===e.type){let n=e.parent,o=n?.type==="parallel"?n:n?.parent,a=o||e;for(n?.type==="compound"&&i.push(u(n.id,void 0!==e.output?S(e.output,l.context,t,r.self):void 0));o?.type==="parallel"&&!h.has(o)&&en(s,o);)h.add(o),i.push(u(o.id)),a=o,o=o.parent;if(o)continue;l=eO(l,{status:"done",output:function(e,t,r,n,s){if(void 0===n.output)return;let i=u(s.id,void 0!==s.output&&s.parent?S(s.output,e.context,t,r.self):void 0);return S(n.output,e.context,i,r.self)}(l,t,r,l.machine.root,a)})}}return l}(c=eb(c,n,r,l.flatMap(e=>e.actions),i,void 0),n,r,l,o,i,a,s);let d=[...o];"done"===c.status&&(c=eb(c,n,r,d.sort((e,t)=>t.order-e.order).flatMap(e=>e.exit),i,void 0));try{if(a===t.historyValue&&function(e,t){if(e.length!==t.size)return!1;for(let r of e)if(!t.has(r))return!1;return!0}(t._nodes,o))return c;return eO(c,{_nodes:d,historyValue:a})}catch(e){throw e}}function eT(e,t,r,n){var s,i,o,a;if(ed(e))if(t[e.id]){let o=t[e.id];for(let e of o)n.add(e),eT(e,t,r,n);for(let a of o){s=a,i=e.parent,ew(n,t,r,Z(s,i))}}else{let s=eu(e);for(let i of s.target)n.add(i),s===e.parent?.initial&&r.add(e.parent),eT(i,t,r,n);for(let i of s.target){o=i,a=e.parent,ew(n,t,r,Z(o,a))}}else if("compound"===e.type){let[s]=e.initial.target;ed(s)||(n.add(s),r.add(s)),eT(s,t,r,n),ew(n,t,r,Z(s,e))}else if("parallel"===e.type)for(let s of Q(e).filter(e=>!ed(e)))[...n].some(e=>ev(e,s))||(ed(s)||(n.add(s),r.add(s)),eT(s,t,r,n))}function ew(e,t,r,n,s){for(let i of n)if((!s||ev(i,s))&&e.add(i),"parallel"===i.type)for(let n of Q(i).filter(e=>!ed(e)))[...e].some(e=>ev(e,n))||(e.add(n),eT(n,t,r,e))}function eb(e,t,r,n,s,i){let o=i?[]:void 0,a=function e(t,r,n,s,i,o){let{machine:a}=t,l=t;for(let t of s){var c;let s="function"==typeof t,u=s?t:(c="string"==typeof t?t:t.type,a.implementations.actions[c]),d={context:l.context,event:r,self:n.self,system:n.system},h=s||"string"==typeof t?void 0:"params"in t?"function"==typeof t.params?t.params({context:l.context,event:r}):t.params:void 0;if(!u||!("resolve"in u)){n.actionExecutor({type:"string"==typeof t?t:"object"==typeof t?t.type:t.name||"(anonymous)",info:d,params:h,exec:u});continue}let[p,f,m]=u.resolve(n,l,d,h,u,i);l=p,"retryResolve"in u&&o?.push([u,f]),"execute"in u&&n.actionExecutor({type:u.type,info:d,params:f,exec:u.execute.bind(null,n,f)}),m&&(l=e(l,r,n,m,i,o))}return l}(e,t,r,n,{internalQueue:s,deferredActorIds:i},o);return o?.forEach(([e,t])=>{e.retryResolve(r,a,t)}),a}function eR(e,t,r,n){let s=e,i=[];function o(e,t,n){r.system._sendInspectionEvent({type:"@xstate.microstep",actorRef:r.self,event:t,snapshot:e,_transitions:n}),i.push(e)}if(t.type===c)return o(s=eO(eA(s,t,r),{status:"stopped"}),t,[]),{snapshot:s,microstates:i};let l=t;if(l.type!==a){let t=l,a=t.type.startsWith("xstate.error.actor"),c=eI(t,s);if(a&&!c.length)return o(s=eO(e,{status:"error",error:t.error}),t,[]),{snapshot:s,microstates:i};o(s=ex(c,e,r,l,!1,n),t,c)}let u=!0;for(;"active"===s.status;){let e=u?function(e,t){let r=new Set;for(let n of e._nodes.filter(J))e:for(let s of[n].concat(Z(n,void 0)))if(s.always){for(let n of s.always)if(void 0===n.guard||z(n.guard,e.context,t,e)){r.add(n);break e}}return ey(Array.from(r),new Set(e._nodes),e.historyValue)}(s,l):[],t=e.length?s:void 0;if(!e.length){if(!n.length)break;e=eI(l=n.shift(),s)}u=(s=ex(e,s,r,l,!1,n))!==t,o(s,l,e)}return"active"!==s.status&&eA(s,l,r),{snapshot:s,microstates:i}}function eA(e,t,r){return eb(e,t,r,Object.values(e.children).map(e=>G(e)),[],void 0)}function eI(e,t){return t.machine.getTransitionData(t,e)}function ek(e,t){let r=ee(eg(e,t));return er(e,[...r])}let eC=function(e){return function e(t,r){let n=g(t),s=g(r);return"string"==typeof s?"string"==typeof n&&s===n:"string"==typeof n?n in s:Object.keys(n).every(t=>t in s&&e(n[t],s[t]))}(e,this.value)},eP=function(e){return this.tags.has(e)},eN=function(e){let t=this.machine.getTransitionData(this,e);return!!t?.length&&t.some(e=>void 0!==e.target||e.actions.length)},eL=function(){let{_nodes:e,tags:t,machine:r,getMeta:n,toJSON:s,can:i,hasTag:o,matches:a,...l}=this;return{...l,tags:Array.from(t)}},eM=function(){return this._nodes.reduce((e,t)=>(void 0!==t.meta&&(e[t.id]=t.meta),e),{})};function eF(e,t){return{status:e.status,output:e.output,error:e.error,machine:t,context:e.context,_nodes:e._nodes,value:er(t.root,e._nodes),tags:new Set(e._nodes.flatMap(e=>e.tags)),children:e.children,historyValue:e.historyValue||{},matches:eC,hasTag:eP,can:eN,getMeta:eM,toJSON:eL}}function eO(e,t={}){return eF({...e,...t},e.machine)}function eU(e,t){let{_nodes:r,tags:n,machine:s,children:i,context:o,can:a,hasTag:l,matches:c,getMeta:u,toJSON:d,...h}=e,p={};for(let e in i){let r=i[e];p[e]={snapshot:r.getPersistedSnapshot(t),src:r.src,systemId:r._systemId,syncSnapshot:r._syncSnapshot}}return{...h,context:function e(t){let r;for(let n in t){let s=t[n];if(s&&"object"==typeof s)if("sessionId"in s&&"send"in s&&"ref"in s)(r??=Array.isArray(t)?t.slice():{...t})[n]={xstate$$type:C,id:s.id};else{let i=e(s);i!==s&&((r??=Array.isArray(t)?t.slice():{...t})[n]=i)}}return r??t}(o),children:p,historyValue:function(e){if("object"!=typeof e||null===e)return{};let t={};for(let r in e){let n=e[r];Array.isArray(n)&&(t[r]=n.map(e=>({id:e.id})))}return t}(h.historyValue)}}function eD(e,t,r,n,{event:s,id:i,delay:o},{internalQueue:a}){let l,c=t.machine.implementations.delays;if("string"==typeof s)throw Error(`Only event objects may be used with raise; use raise({ type: "${s}" }) instead`);let u="function"==typeof s?s(r,n):s;if("string"==typeof o){let e=c&&c[o];l="function"==typeof e?e(r,n):e}else l="function"==typeof o?o(r,n):o;return"number"!=typeof l&&a.push(u),[t,{event:u,id:i,delay:l},void 0]}function ej(e,t){let{event:r,delay:n,id:s}=t;if("number"==typeof n)return void e.defer(()=>{let t=e.self;e.system.scheduler.schedule(t,t,r,n,s)})}function eH(e,t){function r(e,t){}return r.type="xstate.raise",r.event=e,r.id=t?.id,r.delay=t?.delay,r.resolve=eD,r.execute=ej,r}}}]);